<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Day 2 ‚Äî CSPM Foundation: AWS Config</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#0d0f14; --surface:#13161d; --surface2:#181c26;
  --border:#1f2330; --border-hi:#2e3447;
  --text:#c8d0e0; --muted:#5a6178; --faint:#3a3f52;
  --accent:#4af0c4; --accent-dim:rgba(74,240,196,.08);
  --amber:#f0924a; --violet:#8a7fff; --danger:#f05a5a;
  --code-bg:#0a0c10; --pill:#1a1f2e;
  --lab:#f0c84a; --lab-dim:rgba(240,200,74,.08);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;font-weight:300;font-size:15px;line-height:1.75;min-height:100vh;overflow-x:hidden}
.shell{display:grid;grid-template-columns:268px 1fr;min-height:100vh}
.sidebar{background:var(--surface);border-right:1px solid var(--border);padding:32px 0;position:sticky;top:0;height:100vh;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-header{padding:0 24px 24px;border-bottom:1px solid var(--border)}
.day-badge{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.12em;text-transform:uppercase;color:var(--accent);margin-bottom:6px}
.sidebar-header h2{font-family:'DM Serif Display',serif;font-size:15px;font-weight:400;color:#e4eaf6;line-height:1.4}
.sidebar-meta{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
.chip{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.06em;background:var(--pill);color:var(--muted);padding:3px 8px;border-radius:3px}
.lesson-nav{padding:16px 0;flex:1}
.nav-group-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--faint);padding:10px 24px 6px}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 24px;cursor:pointer;transition:background .15s;border-left:2px solid transparent}
.nav-item:hover{background:rgba(255,255,255,.03)}
.nav-item.active{background:var(--accent-dim);border-left-color:var(--accent)}
.nav-item.active .nav-label{color:var(--accent)}
.nav-item.lab-item.active{background:var(--lab-dim);border-left-color:var(--lab)}
.nav-item.lab-item.active .nav-label{color:var(--lab)}
.nav-num{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);width:18px;flex-shrink:0;text-align:right}
.nav-label{font-size:12.5px;color:#8a92a8;line-height:1.3}
.nav-check{margin-left:auto;width:14px;height:14px;border-radius:50%;border:1px solid var(--border-hi);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:8px;color:transparent;transition:all .2s}
.nav-item.done .nav-check{background:var(--accent);border-color:var(--accent);color:var(--bg)}
.nav-item.lab-item.done .nav-check{background:var(--lab);border-color:var(--lab);color:var(--bg)}
.sidebar-footer{padding:20px 24px;border-top:1px solid var(--border);margin-top:auto}
.progress-label{display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-bottom:8px}
.progress-bar{height:3px;background:var(--border);border-radius:2px;overflow:hidden}
.progress-fill{height:100%;background:var(--accent);border-radius:2px;transition:width .4s ease;width:0%}

/* ‚îÄ‚îÄ Sidebar back navigation ‚îÄ‚îÄ */
.sidebar-back{padding:14px 24px 12px;border-bottom:1px solid var(--border);display:flex;flex-direction:column;gap:6px}
.back-index{display:flex;align-items:center;gap:8px;font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.06em;color:var(--muted);text-decoration:none;padding:6px 10px;border-radius:5px;border:1px solid var(--border-hi);transition:all .15s;background:transparent}
.back-index:hover{color:var(--accent);border-color:var(--accent);background:var(--accent-dim)}
.back-index svg{flex-shrink:0;opacity:.6}
.week-jumps-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--faint);margin-bottom:1px}
.week-jumps{display:flex;gap:5px;flex-wrap:wrap;margin-top:2px}
.week-jump{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.06em;padding:3px 9px;border-radius:3px;border:1px solid var(--border-hi);color:var(--muted);text-decoration:none;transition:all .12s;background:transparent}
.week-jump:hover{color:var(--text);background:rgba(255,255,255,.04)}
.week-jump.wj1{color:#4af0c4;border-color:rgba(74,240,196,.3)}
.week-jump.wj2{color:#8a7fff;border-color:rgba(138,127,255,.3)}
.week-jump.wj3{color:#f0924a;border-color:rgba(240,146,74,.3)}
.week-jump.wj4{color:#f05a5a;border-color:rgba(240,90,90,.3)}

/* ‚îÄ‚îÄ Day nav strip ‚îÄ‚îÄ */
.day-nav-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--faint);margin-top:8px;margin-bottom:2px}
.day-nav{display:flex;gap:4px;flex-wrap:wrap}
.day-link{font-family:'IBM Plex Mono',monospace;font-size:9px;padding:3px 7px;border-radius:3px;border:1px solid var(--border-hi);color:var(--muted);text-decoration:none;transition:all .12s;background:transparent}
.day-link:hover{color:var(--text);background:rgba(255,255,255,.04)}
.day-link.current{color:var(--accent);border-color:rgba(74,240,196,.4);background:rgba(74,240,196,.06);font-weight:600}

.main{display:flex;flex-direction:column}
.lesson-topbar{display:flex;align-items:center;justify-content:space-between;padding:16px 48px;border-bottom:1px solid var(--border);background:var(--surface);position:sticky;top:0;z-index:10}
.lesson-crumb{font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--muted)}
.lesson-crumb span{color:var(--text)}
.nav-arrows{display:flex;gap:8px}
.arrow-btn{background:var(--pill);border:1px solid var(--border-hi);color:var(--muted);border-radius:5px;padding:5px 12px;font-size:12px;cursor:pointer;font-family:'IBM Plex Mono',monospace;transition:all .15s}
.arrow-btn:hover:not(:disabled){border-color:var(--accent);color:var(--accent)}
.arrow-btn:disabled{opacity:.3;cursor:default}
.lesson-pane{display:none;flex-direction:column;padding:56px 48px 80px;max-width:760px;animation:fadeIn .3s ease}
.lesson-pane.active{display:flex}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.lesson-tag{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.12em;text-transform:uppercase;margin-bottom:14px}
.tag-concept{color:var(--violet)} .tag-warning{color:var(--amber)} .tag-security{color:var(--accent)} .tag-ops{color:#f0c84a} .tag-lab{color:var(--lab)}
.lesson-pane h1{font-family:'DM Serif Display',serif;font-size:28px;font-weight:400;line-height:1.25;color:#e8eef8;margin-bottom:24px}
.lesson-pane h1 em{font-style:italic;color:var(--accent)}
.lab-pane h1 em{color:var(--lab)}
.lesson-pane p{color:var(--text);margin-bottom:18px;font-size:15px}
.lesson-pane strong{color:#e0e6f0;font-weight:500}
.callout{border-left:3px solid;padding:16px 20px;border-radius:0 6px 6px 0;margin:24px 0;font-size:14px;line-height:1.7}
.callout-title{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.1em;text-transform:uppercase;margin-bottom:8px;font-weight:600}
.callout.breach{border-color:var(--danger);background:rgba(240,90,90,.06)}.callout.breach .callout-title{color:var(--danger)}
.callout.insight{border-color:var(--violet);background:rgba(138,127,255,.06)}.callout.insight .callout-title{color:var(--violet)}
.callout.tip{border-color:var(--accent);background:var(--accent-dim)}.callout.tip .callout-title{color:var(--accent)}
.callout.warning{border-color:var(--amber);background:rgba(240,146,74,.06)}.callout.warning .callout-title{color:var(--amber)}
.callout.lab-note{border-color:var(--lab);background:var(--lab-dim)}.callout.lab-note .callout-title{color:var(--lab)}
.styled-table{width:100%;border-collapse:collapse;margin:24px 0;font-size:13.5px}
.styled-table th{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--muted);text-align:left;padding:10px 16px;border-bottom:1px solid var(--border);background:var(--surface)}
.styled-table td{padding:11px 16px;border-bottom:1px solid var(--border);color:var(--text);vertical-align:top}
.styled-table tr:hover td{background:rgba(255,255,255,.02)}
.styled-table td:first-child{font-family:'IBM Plex Mono',monospace;font-size:11.5px;color:var(--violet)}
.layers{display:flex;flex-direction:column;margin:24px 0;border:1px solid var(--border);border-radius:8px;overflow:hidden}
.layer{display:grid;grid-template-columns:160px 1fr;border-bottom:1px solid var(--border)}
.layer:last-child{border-bottom:none}
.layer:hover{background:rgba(74,240,196,.02)}
.layer-left{padding:18px 20px;border-right:1px solid var(--border);background:var(--surface);display:flex;flex-direction:column;gap:4px}
.layer-num{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.12em;color:var(--muted);text-transform:uppercase}
.layer-name{font-family:'DM Serif Display',serif;font-size:14px;color:#e4eaf6;font-weight:400}
.layer-right{padding:18px 24px;font-size:13.5px;color:#8a92a8;line-height:1.65}
.layer-right strong{color:var(--text);display:block;margin-bottom:3px}
.split{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin:24px 0}
.split-card{border:1px solid var(--border);border-radius:8px;overflow:hidden}
.split-head{padding:12px 18px;font-family:'IBM Plex Mono',monospace;font-size:11px;font-weight:600}
.split-card.managed .split-head{background:rgba(138,127,255,.08);color:var(--violet)}
.split-card.custom .split-head{background:rgba(240,146,74,.08);color:var(--amber)}
.split-body{padding:16px 18px;font-size:13.5px;line-height:1.65;color:#8a92a8}
.split-body strong{color:var(--text);display:block;margin-bottom:6px}
.fp-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;margin:24px 0;overflow:hidden}
.fp-header{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;border-bottom:1px solid var(--border);background:rgba(240,90,90,.04)}
.fp-rule{font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--danger)}
.fp-badge{font-family:'IBM Plex Mono',monospace;font-size:10px;background:rgba(240,90,90,.12);color:var(--danger);padding:3px 10px;border-radius:3px}
.fp-body{padding:18px 20px;display:flex;flex-direction:column;gap:14px}
.fp-row{display:flex;gap:14px;align-items:flex-start}
.fp-icon{font-size:18px;flex-shrink:0;width:26px}
.fp-text{font-size:13.5px;color:#8a92a8;line-height:1.55}
.fp-text strong{color:var(--text)}
.fp-resolution{padding:14px 20px;background:rgba(74,240,196,.05);border-top:1px solid var(--border);font-size:13.5px;color:var(--accent);display:flex;align-items:flex-start;gap:10px}
.code-block{background:var(--code-bg);border:1px solid var(--border);border-radius:6px;margin:20px 0;overflow:hidden}
.code-header{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;border-bottom:1px solid var(--border);background:rgba(255,255,255,.02)}
.code-lang{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.06em;color:var(--muted);text-transform:uppercase}
.copy-btn{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);background:transparent;border:1px solid var(--border-hi);border-radius:3px;padding:2px 8px;cursor:pointer;transition:all .15s}
.copy-btn:hover{color:var(--accent);border-color:var(--accent)}
.code-block pre{font-family:'IBM Plex Mono',monospace;font-size:12.5px;line-height:1.8;padding:16px 20px;color:#a8b4cc;overflow-x:auto}
.code-block pre .hl{color:var(--accent)} .code-block pre .hl2{color:var(--amber)} .code-block pre .comment{color:var(--muted)}
.kcheck{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:28px 28px 24px;margin:36px 0 24px}
.kcheck-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--violet);margin-bottom:14px}
.kcheck-q{font-size:15px;color:#d0d8ec;font-weight:500;margin-bottom:20px;line-height:1.5}
.kcheck-options{display:flex;flex-direction:column;gap:10px}
.kcheck-opt{display:flex;align-items:flex-start;gap:12px;padding:12px 16px;border:1px solid var(--border-hi);border-radius:7px;cursor:pointer;transition:all .15s;font-size:13.5px;color:#8a92a8;background:transparent;width:100%;text-align:left}
.kcheck-opt:hover:not(.disabled){border-color:var(--violet);background:rgba(138,127,255,.05);color:var(--text)}
.kcheck-opt.correct{border-color:var(--accent);background:rgba(74,240,196,.07);color:var(--accent)}
.kcheck-opt.wrong{border-color:var(--danger);background:rgba(240,90,90,.07);color:var(--danger)}
.kcheck-opt.reveal-correct{border-color:var(--accent);background:rgba(74,240,196,.04);color:#6e9e90}
.opt-key{font-family:'IBM Plex Mono',monospace;font-size:11px;width:22px;height:22px;border-radius:4px;background:var(--border);display:flex;align-items:center;justify-content:center;flex-shrink:0;color:var(--muted);transition:all .15s;margin-top:1px}
.kcheck-opt.correct .opt-key{background:var(--accent);color:var(--bg)}
.kcheck-opt.wrong .opt-key{background:var(--danger);color:#fff}
.kcheck-opt.reveal-correct .opt-key{background:rgba(74,240,196,.2);color:var(--accent)}
.kcheck-feedback{margin-top:18px;padding:14px 16px;border-radius:7px;font-size:13.5px;line-height:1.65;display:none}
.kcheck-feedback.show{display:block}
.kcheck-feedback.good{background:rgba(74,240,196,.08);border:1px solid rgba(74,240,196,.2);color:#7eceb8}
.kcheck-feedback.bad{background:rgba(240,90,90,.08);border:1px solid rgba(240,90,90,.2);color:#c47a7a}
.lab-steps{display:flex;flex-direction:column;gap:0;margin:24px 0}
.lab-step{display:flex;gap:20px;padding:20px 0;border-bottom:1px solid var(--border)}
.lab-step:last-child{border-bottom:none}
.step-num-wrap{display:flex;flex-direction:column;align-items:center;flex-shrink:0}
.step-num{width:32px;height:32px;border-radius:50%;background:var(--pill);border:2px solid var(--border-hi);font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--muted);display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .3s;position:relative;z-index:1}
.step-connector{width:2px;flex:1;background:var(--border);margin-top:4px}
.lab-step:last-child .step-connector{display:none}
.lab-step.completed .step-num{background:var(--lab);border-color:var(--lab);color:var(--bg)}
.step-content{flex:1;padding-top:4px}
.step-title{font-family:'DM Serif Display',serif;font-size:16px;color:#e4eaf6;margin-bottom:8px}
.step-body{font-size:14px;color:var(--text);line-height:1.7}
.step-body ol{padding-left:20px;display:flex;flex-direction:column;gap:6px;margin:10px 0}
.step-body li{color:#a0a8bc}
.step-body code{font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 6px;border-radius:3px;color:var(--violet)}
.checklist{display:flex;flex-direction:column;gap:10px;margin:24px 0}
.check-item{display:flex;align-items:flex-start;gap:12px;padding:12px 16px;background:var(--surface);border:1px solid var(--border);border-radius:7px;cursor:pointer;transition:all .2s;user-select:none}
.check-item:hover{border-color:var(--border-hi)}
.check-item.checked{border-color:rgba(240,200,74,.3);background:rgba(240,200,74,.05)}
.check-box{width:18px;height:18px;border-radius:4px;border:2px solid var(--border-hi);flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .2s;margin-top:1px;font-size:10px;color:transparent}
.check-item.checked .check-box{background:var(--lab);border-color:var(--lab);color:var(--bg)}
.check-text{font-size:13.5px;color:#8a92a8;line-height:1.5}
.check-item.checked .check-text{color:var(--muted);text-decoration:line-through;text-decoration-color:var(--faint)}
.checklist-progress{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.checklist-progress-bar{flex:1;height:3px;background:var(--border);border-radius:2px;overflow:hidden}
.checklist-progress-fill{height:100%;background:var(--lab);border-radius:2px;transition:width .4s ease}
.checklist-progress-label{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);white-space:nowrap}
.lesson-nav-footer{display:flex;justify-content:space-between;align-items:center;margin-top:52px;padding-top:28px;border-top:1px solid var(--border)}
.next-btn{background:var(--accent);color:var(--bg);border:none;border-radius:6px;padding:11px 24px;font-family:'IBM Plex Mono',monospace;font-size:12px;font-weight:600;cursor:pointer;letter-spacing:.04em;transition:opacity .15s;display:flex;align-items:center;gap:8px;text-decoration:none}
.next-btn:hover{opacity:.88}
.next-btn.lab-btn{background:var(--lab)}
.prev-btn{background:transparent;color:var(--muted);border:1px solid var(--border-hi);border-radius:6px;padding:11px 20px;font-family:'IBM Plex Mono',monospace;font-size:12px;cursor:pointer;letter-spacing:.04em;transition:all .15s}
.prev-btn:hover{color:var(--text);border-color:var(--text)}
.prev-btn:disabled{opacity:.3;cursor:default}
.completion-card{text-align:center;padding:56px 32px}
.completion-icon{font-size:48px;margin-bottom:20px;display:block}
.completion-card h1{font-family:'DM Serif Display',serif;font-size:32px;color:var(--accent);margin-bottom:12px}
.completion-card p{color:var(--muted);max-width:420px;margin:0 auto 28px;font-size:14px}
.score-pill{display:inline-flex;align-items:center;gap:8px;background:rgba(74,240,196,.1);border:1px solid rgba(74,240,196,.25);color:var(--accent);border-radius:40px;padding:8px 20px;font-family:'IBM Plex Mono',monospace;font-size:13px;margin-bottom:8px}
.lab-score-pill{display:inline-flex;align-items:center;gap:8px;background:rgba(240,200,74,.1);border:1px solid rgba(240,200,74,.25);color:var(--lab);border-radius:40px;padding:8px 20px;font-family:'IBM Plex Mono',monospace;font-size:13px;margin-bottom:32px}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border-hi);border-radius:3px}
@media(max-width:768px){.shell{grid-template-columns:1fr}.sidebar{display:none}.lesson-pane{padding:32px 24px 60px}.split{grid-template-columns:1fr}.lesson-topbar{padding:14px 24px}}
</style>
</head>
<body>
<div class="shell">

<nav class="sidebar">
  <div class="sidebar-header">
    <div class="day-badge">Week 1 ¬∑ Day 2</div>
    <h2>CSPM Foundation:<br>AWS Config</h2>
    <div class="sidebar-meta">
      <span class="chip">Beginner</span>
      <span class="chip">4 lessons</span>
      <span class="chip">1 lab</span>
      <span class="chip">~4h</span>
    </div>
  </div>
  <div class="sidebar-back">
    <a class="back-index" href="../index.html">
      <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M7.5 2L3.5 6L7.5 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Course Index
    </a>
    <div class="week-jumps-label">Jump to week</div>
    <div class="week-jumps">
      <a class="week-jump wj1" href="../index.html#week-1">W1</a>
      <a class="week-jump wj2" href="../index.html#week-2">W2</a>
      <a class="week-jump wj3" href="../index.html#week-3">W3</a>
      <a class="week-jump wj4" href="../index.html#week-4">W4</a>
    </div>
    <div class="day-nav-label">Week 1 days</div>
    <div class="day-nav">
      <a class="day-link" href="day-01.html">D1</a>
      <a class="day-link current" href="day-02.html">D2</a>
      <a class="day-link" href="day-03.html">D3</a>
      <a class="day-link" href="day-04.html">D4</a>
      <a class="day-link" href="day-05.html">D5</a>
      <a class="day-link" href="day-06.html">D6</a>
      <a class="day-link" href="day-07.html">D7</a>
    </div>
  </div>
  <div class="lesson-nav">
    <div class="nav-group-label">Lessons</div>
    <div class="nav-item active" onclick="goTo(0)"><span class="nav-num">01</span><span class="nav-label">What Is CSPM?</span><span class="nav-check">‚úì</span></div>
    <div class="nav-item" onclick="goTo(1)"><span class="nav-num">02</span><span class="nav-label">How AWS Config Works</span><span class="nav-check">‚úì</span></div>
    <div class="nav-item" onclick="goTo(2)"><span class="nav-num">03</span><span class="nav-label">Managed Rules vs. Custom Rules</span><span class="nav-check">‚úì</span></div>
    <div class="nav-item" onclick="goTo(3)"><span class="nav-num">04</span><span class="nav-label">The False Positive Problem</span><span class="nav-check">‚úì</span></div>
    <div class="nav-group-label" style="margin-top:8px">Lab</div>
    <div class="nav-item lab-item" onclick="goTo(4)"><span class="nav-num" style="color:var(--lab)">üî¨</span><span class="nav-label">Hands-on: Enable AWS Config</span><span class="nav-check">‚úì</span></div>
  </div>
  <div class="sidebar-footer">
    <div class="progress-label"><span>Progress</span><span id="progress-pct">0 / 5</span></div>
    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
  </div>
</nav>

<div class="main">
  <div class="lesson-topbar">
    <div class="lesson-crumb">Day 2 &nbsp;/&nbsp; <span id="topbar-title">What Is CSPM?</span></div>
    <div class="nav-arrows">
      <button class="arrow-btn" id="btn-prev" onclick="prev()" disabled>‚Üê Prev</button>
      <button class="arrow-btn" id="btn-next" onclick="next()">Next ‚Üí</button>
    </div>
  </div>

  <!-- LESSON 1 -->
  <div class="lesson-pane active" id="pane-0">
    <div class="lesson-tag tag-concept">Core Concept</div>
    <h1>What Is <em>CSPM?</em></h1>
    <p>Traditional security tools watch for malicious <strong>behaviour</strong> ‚Äî an attacker running commands, moving data. CSPM watches for something different and more common: dangerous <strong>configuration</strong>.</p>
    <p>Cloud Security Posture Management answers one question, continuously:</p>
    <div class="callout insight"><div class="callout-title">üí° The CSPM Question</div><em>"Are our cloud resources configured the way we think they are ‚Äî right now?"</em><br><br>An S3 bucket left public, a security group open to the internet, a database with encryption off ‚Äî CSPM finds these before an attacker does.</div>
    <p><strong>Why misconfigurations dominate cloud incidents.</strong> Cloud resources spin up via API calls in seconds. A single deployment can create dozens of resources with subtly wrong settings. Developers move fast and don't always know secure defaults. Manual reviews can't keep pace.</p>
    <div class="callout breach"><div class="callout-title">‚ö† Real Breach ‚Äî Capital One (2019)</div>An attacker exploited a misconfigured WAF on EC2 to access an IAM role, then used that role's excessive permissions to pull data from over 100 S3 buckets. AWS's infrastructure was untouched ‚Äî every failure was a customer-side configuration mistake. Exactly what CSPM is designed to catch.</div>
    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">A developer deploys an RDS database with encryption disabled. No attacker has accessed it yet. Which tool category is designed to detect this?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,0)"><span class="opt-key">A</span>IDS ‚Äî monitors for malicious network activity</button>
        <button class="kcheck-opt" onclick="check(this,false,0)"><span class="opt-key">B</span>SIEM ‚Äî aggregates security event logs from multiple sources</button>
        <button class="kcheck-opt" onclick="check(this,true,0)"><span class="opt-key">C</span>CSPM ‚Äî continuously checks whether cloud resources are configured securely</button>
        <button class="kcheck-opt" onclick="check(this,false,0)"><span class="opt-key">D</span>EDR ‚Äî monitors endpoint behaviour for malicious processes</button>
      </div>
      <div class="kcheck-feedback" id="fb-0"></div>
    </div>
    <div class="lesson-nav-footer">
      <button class="prev-btn" disabled>‚Üê Previous</button>
      <button class="next-btn" onclick="next()">Next Lesson ‚Üí</button>
    </div>
  </div>

  <!-- LESSON 2 -->
  <div class="lesson-pane" id="pane-1">
    <div class="lesson-tag tag-security">Architecture</div>
    <h1>How AWS Config <em>Works</em></h1>
    <p>AWS Config is AWS's native CSPM service. It operates across three distinct layers, each building on the previous one.</p>
    <div class="layers">
      <div class="layer">
        <div class="layer-left"><div class="layer-num">Layer 1</div><div class="layer-name">Resource Recording</div></div>
        <div class="layer-right"><strong>Continuous configuration snapshots</strong>Tracks every supported resource type ‚Äî EC2, S3, IAM roles, security groups, VPCs, RDS, and hundreds more. Every snapshot is stored in an S3 bucket you own.</div>
      </div>
      <div class="layer">
        <div class="layer-left"><div class="layer-num">Layer 2</div><div class="layer-name">Configuration Timeline</div></div>
        <div class="layer-right"><strong>Full change history with attribution</strong>Every configuration change is recorded: what changed, when, and which IAM identity made it. If someone opens port 22 to the internet on Tuesday, Config records exactly that ‚Äî invaluable for incident investigation.</div>
      </div>
      <div class="layer">
        <div class="layer-left"><div class="layer-num">Layer 3</div><div class="layer-name">Rules &amp; Compliance</div></div>
        <div class="layer-right"><strong>Automated compliance evaluation</strong>Rules define what "compliant" looks like. When a resource drifts from compliant, Config flags it immediately. Optionally triggers auto-remediation via AWS Systems Manager.</div>
      </div>
    </div>
    <div class="callout tip"><div class="callout-title">‚úì Config's Forensic Value</div>When an incident occurs, the configuration timeline lets you answer: "What was this resource's state before, during, and after the breach?" You see exactly when a setting changed and whose credentials made the change ‚Äî no extra setup required.</div>
    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">A security engineer needs to know: "When was this S3 bucket's public access block disabled, and which IAM identity changed it?" Which Config layer provides this?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,1)"><span class="opt-key">A</span>Layer 1 (Resource Recording) ‚Äî snapshots current configuration state</button>
        <button class="kcheck-opt" onclick="check(this,true,1)"><span class="opt-key">B</span>Layer 2 (Configuration Timeline) ‚Äî stores full change history with timestamps and IAM identity</button>
        <button class="kcheck-opt" onclick="check(this,false,1)"><span class="opt-key">C</span>Layer 3 (Rules & Compliance) ‚Äî evaluates resources against rules</button>
        <button class="kcheck-opt" onclick="check(this,false,1)"><span class="opt-key">D</span>None ‚Äî you need CloudTrail for this, not Config</button>
      </div>
      <div class="kcheck-feedback" id="fb-1"></div>
    </div>
    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn" onclick="next()">Next Lesson ‚Üí</button>
    </div>
  </div>

  <!-- LESSON 3 -->
  <div class="lesson-pane" id="pane-2">
    <div class="lesson-tag tag-warning">Rules</div>
    <h1>Managed Rules vs.<br><em>Custom Rules</em></h1>
    <div class="split">
      <div class="split-card managed">
        <div class="split-head">Managed Rules</div>
        <div class="split-body"><strong>Pre-built by AWS, enabled in seconds</strong>Cover the most common security requirements. Map directly to CIS Benchmark controls. Updated by AWS as standards evolve.<br><br><span style="color:var(--violet)">Best for:</span> Industry-standard requirements that apply to almost every AWS account.</div>
      </div>
      <div class="split-card custom">
        <div class="split-head">Custom Rules</div>
        <div class="split-body"><strong>Lambda functions you write yourself</strong>Used when managed rules don't cover your requirements. Any logic you can express in code.<br><br><span style="color:var(--amber)">Best for:</span> Organisation-specific standards ‚Äî tag policies, naming conventions, internal compliance.</div>
      </div>
    </div>
    <p>For this programme you'll use managed rules. Here are the four you'll activate today:</p>
    <table class="styled-table">
      <thead><tr><th>Rule name</th><th>What it checks</th></tr></thead>
      <tbody>
        <tr><td>root-account-mfa-enabled</td><td>Root account must have MFA active</td></tr>
        <tr><td>s3-bucket-public-read-prohibited</td><td>S3 buckets must not allow public read</td></tr>
        <tr><td>mfa-enabled-for-iam-console-access</td><td>Console users must have MFA enabled</td></tr>
        <tr><td>ec2-instances-in-vpc</td><td>EC2 instances must be inside a VPC</td></tr>
      </tbody>
    </table>
    <div class="callout insight"><div class="callout-title">üí° Custom Rule Example</div>Your company requires every EC2 instance to have an <strong>Owner</strong> tag. No managed rule checks this. A custom rule ‚Äî a Lambda that inspects each instance's tags and returns COMPLIANT or NON_COMPLIANT ‚Äî handles it exactly.</div>
    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Your policy requires every S3 bucket to have the tag <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">DataClassification=Confidential</code>. Which type of Config rule should you use?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,2)"><span class="opt-key">A</span>Managed rule ‚Äî AWS provides tag-checking rules for all use cases</button>
        <button class="kcheck-opt" onclick="check(this,true,2)"><span class="opt-key">B</span>Custom rule ‚Äî a Lambda that checks for the specific tag key and value your policy requires</button>
        <button class="kcheck-opt" onclick="check(this,false,2)"><span class="opt-key">C</span>Neither ‚Äî Config doesn't support tag-based compliance checks</button>
        <button class="kcheck-opt" onclick="check(this,false,2)"><span class="opt-key">D</span>Managed rule ‚Äî use the existing required-tags rule with a custom parameter</button>
      </div>
      <div class="kcheck-feedback" id="fb-2"></div>
    </div>
    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn" onclick="next()">Next Lesson ‚Üí</button>
    </div>
  </div>

  <!-- LESSON 4 -->
  <div class="lesson-pane" id="pane-3">
    <div class="lesson-tag tag-ops">Operations</div>
    <h1>The False Positive <em>Problem</em></h1>
    <p>Not every Config finding is a real problem. In mature environments around <strong>40% of findings are intentional exceptions</strong> ‚Äî resources that violate the rule's letter but not its intent.</p>
    <p>The skill in CSPM operations isn't just finding misconfigurations. It's <strong>contextualising them</strong> ‚Äî determining which findings represent real risk versus known, business-justified exceptions.</p>
    <div class="fp-card">
      <div class="fp-header">
        <span class="fp-rule">s3-bucket-public-read-prohibited</span>
        <span class="fp-badge">NON_COMPLIANT</span>
      </div>
      <div class="fp-body">
        <div class="fp-row"><span class="fp-icon">ü™£</span><div class="fp-text"><strong>Resource:</strong> company-marketing-website-assets</div></div>
        <div class="fp-row"><span class="fp-icon">üîç</span><div class="fp-text"><strong>Is this a real problem?</strong> No. This bucket hosts your public marketing website ‚Äî it <em>must</em> be publicly readable.</div></div>
        <div class="fp-row"><span class="fp-icon">‚ö†Ô∏è</span><div class="fp-text"><strong>Safe to ignore?</strong> Only with documentation. An undocumented exception looks identical to a genuine misconfiguration in any audit.</div></div>
      </div>
      <div class="fp-resolution"><span>‚úì</span><span><strong>Correct action:</strong> Suppress the finding with written justification ‚Äî "Intentional: public S3 bucket for marketing website, reviewed [date] by [name]." Now it's a documented exception, not a gap.</span></div>
    </div>
    <div class="callout warning">
      <div class="callout-title">‚ö† The Two Wrong Responses</div>
      <strong>Ignore it</strong> ‚Äî the finding stays active. An auditor sees NON_COMPLIANT with no review trail. Audit risk.<br><br>
      <strong>Disable the rule</strong> ‚Äî now it won't fire for the exception <em>or</em> for any real misconfiguration. You've lost the control entirely.
    </div>
    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Config flags your public marketing website's S3 bucket as NON_COMPLIANT. The bucket must be public. What is the correct response?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,3)"><span class="opt-key">A</span>Make the bucket private and use CloudFront in front of it to fix the finding</button>
        <button class="kcheck-opt" onclick="check(this,false,3)"><span class="opt-key">B</span>Disable the rule ‚Äî it doesn't apply to your environment</button>
        <button class="kcheck-opt" onclick="check(this,true,3)"><span class="opt-key">C</span>Suppress the finding with documented justification ‚Äî it's an intentional, reviewed exception</button>
        <button class="kcheck-opt" onclick="check(this,false,3)"><span class="opt-key">D</span>Ignore it ‚Äî Config false positives don't need to be addressed</button>
      </div>
      <div class="kcheck-feedback" id="fb-3"></div>
    </div>
    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn lab-btn" onclick="next()">Start Lab ‚Üí</button>
    </div>
  </div>

  <!-- LAB -->
  <div class="lesson-pane lab-pane" id="pane-4">
    <div class="lesson-tag tag-lab">üî¨ Hands-On Lab</div>
    <h1>Enable AWS <em>Config</em></h1>
    <p>Time to deploy your first CSPM layer. You need the AWS Console open alongside this page. The whole lab takes around 45 minutes.</p>
    <div class="callout lab-note"><div class="callout-title">‚ö° Before You Start</div>Ensure you're logged in as your IAM admin user from Day 1 ‚Äî not root. Config requires IAM permissions that work best with AdministratorAccess.</div>

    <div class="lab-steps">
      <div class="lab-step">
        <div class="step-num-wrap"><div class="step-num">1</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Enable AWS Config <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~20 min</span></div>
          <div class="step-body">
            <ol>
              <li>AWS Console ‚Üí search <code>Config</code> ‚Üí <strong>AWS Config</strong></li>
              <li>Click <strong>Get started</strong></li>
              <li>Configure recording:<br>
                ‚úÖ <strong>Record all resources supported in this region</strong><br>
                ‚úÖ <strong>Include global resources (e.g. IAM)</strong> ‚Äî captures IAM users, roles, policies</li>
              <li><strong>Amazon S3 bucket:</strong> Select <strong>Create a bucket</strong> ‚Äî Config names it automatically</li>
              <li><strong>AWS Config role:</strong> Select <strong>Create AWS Config service-linked role</strong></li>
              <li>Click <strong>Next</strong> ‚Üí <strong>Next</strong> ‚Üí <strong>Confirm</strong></li>
            </ol>
            <div class="callout tip" style="margin-top:12px;margin-bottom:0"><div class="callout-title">‚úì Wait for Discovery</div>After enabling, wait 5‚Äì10 minutes for Config to complete its initial resource discovery. Watch the resource count climb in the dashboard.</div>
          </div>
        </div>
      </div>

      <div class="lab-step">
        <div class="step-num-wrap"><div class="step-num">2</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Enable Your First Managed Rules <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~20 min</span></div>
          <div class="step-body">
            <ol>
              <li>Config ‚Üí left menu ‚Üí <strong>Rules</strong> ‚Üí <strong>Add rule</strong></li>
              <li>Search: <code>root-account-mfa-enabled</code> ‚Üí select ‚Üí <strong>Next</strong> ‚Üí <strong>Save</strong></li>
              <li>Repeat for: <code>s3-bucket-public-read-prohibited</code></li>
              <li>Repeat for: <code>mfa-enabled-for-iam-console-access</code></li>
              <li>Repeat for: <code>ec2-instances-in-vpc</code></li>
            </ol>
            <p style="color:#8a92a8;font-size:13px;margin-top:8px">Config evaluates each rule within a few minutes of activation. You should see <strong>root-account-mfa-enabled</strong> show Compliant immediately ‚Äî you did that on Day 1.</p>
          </div>
        </div>
      </div>

      <div class="lab-step">
        <div class="step-num-wrap"><div class="step-num">3</div></div>
        <div class="step-content">
          <div class="step-title">Read Your First Results <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~10 min</span></div>
          <div class="step-body">
            <ol>
              <li>Config ‚Üí <strong>Rules</strong> ‚Üí click <code>root-account-mfa-enabled</code> ‚Üí verify status is <strong>Compliant</strong></li>
              <li>Click <code>mfa-enabled-for-iam-console-access</code> ‚Äî check which IAM users are flagged</li>
              <li>Config ‚Üí <strong>Dashboard</strong> ‚Äî note total resource count and compliance percentage</li>
              <li>Click any non-compliant resource ‚Üí read the finding detail ‚Äî observe how Config identifies exactly which configuration attribute caused the failure</li>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <h2 style="font-family:'DM Serif Display',serif;font-size:20px;color:#e4eaf6;margin:32px 0 16px;font-weight:400">Completion Checklist</h2>
    <p style="font-size:13px;color:var(--muted);margin-bottom:16px">Tick each item as you complete it. Your progress is saved automatically.</p>
    <div class="checklist-progress">
      <div class="checklist-progress-bar"><div class="checklist-progress-fill" id="cl-fill"></div></div>
      <span class="checklist-progress-label" id="cl-label">0 / 8</span>
    </div>
    <div class="checklist">
      <div class="check-item" onclick="toggleCheck(this,0)"><div class="check-box">‚úì</div><div class="check-text">AWS Config enabled with all resources recorded in this region</div></div>
      <div class="check-item" onclick="toggleCheck(this,1)"><div class="check-box">‚úì</div><div class="check-text">Global resources (IAM) included in recording</div></div>
      <div class="check-item" onclick="toggleCheck(this,2)"><div class="check-box">‚úì</div><div class="check-text">Config S3 bucket created and receiving snapshots</div></div>
      <div class="check-item" onclick="toggleCheck(this,3)"><div class="check-box">‚úì</div><div class="check-text"><code style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--violet)">root-account-mfa-enabled</code> rule active and showing Compliant</div></div>
      <div class="check-item" onclick="toggleCheck(this,4)"><div class="check-box">‚úì</div><div class="check-text"><code style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--violet)">s3-bucket-public-read-prohibited</code> rule active</div></div>
      <div class="check-item" onclick="toggleCheck(this,5)"><div class="check-box">‚úì</div><div class="check-text"><code style="font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--violet)">mfa-enabled-for-iam-console-access</code> rule active</div></div>
      <div class="check-item" onclick="toggleCheck(this,6)"><div class="check-box">‚úì</div><div class="check-text">Screenshot of Config Dashboard showing resource count and compliance overview</div></div>
      <div class="check-item" onclick="toggleCheck(this,7)"><div class="check-box">‚úì</div><div class="check-text">Screenshot of at least one rule evaluation result</div></div>
    </div>

    <h2 style="font-family:'DM Serif Display',serif;font-size:20px;color:#e4eaf6;margin:32px 0 16px;font-weight:400">Portfolio Commit</h2>
    <div class="code-block">
      <div class="code-header"><span class="code-lang">bash</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div>
      <pre>git add screenshots/day-02-*.png
git commit -m <span class="hl">"Day 02: AWS Config enabled, 4 managed rules active, CSPM baseline established"</span>
git push</pre>
    </div>

    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn lab-btn" onclick="finish()">Complete Day 2 ‚úì</button>
    </div>
  </div>

  <!-- COMPLETION -->
  <div class="lesson-pane" id="pane-complete">
    <div class="completion-card">
      <span class="completion-icon">üì°</span>
      <h1>Day 2 Complete</h1>
      <p>You understand CSPM, how Config's three layers work, the difference between managed and custom rules, and how to handle false positives without creating audit gaps.</p>
      <div class="score-pill"><span>‚ö°</span> Quiz: <span id="score-val">‚Äî</span></div><br>
      <div class="lab-score-pill"><span>üî¨</span> Lab: <span id="lab-score-val">‚Äî</span> checklist items</div>
      <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:8px">
        <button class="prev-btn" onclick="goTo(0);resetAll()">‚Ü© Review</button>
        <a href="../../index.html" style="text-decoration:none"><button class="next-btn" style="background:var(--pill);color:var(--muted);border:1px solid var(--border-hi)">‚Üê Course Index</button></a>
      </div>
    </div>
  </div>

</div>
</div>

<script>
const STORAGE_KEY = 'csm-day02';
const TOTAL = 5;
const titles = ['What Is CSPM?','How AWS Config Works','Managed Rules vs. Custom Rules','The False Positive Problem','Hands-on: Enable AWS Config'];
const fb = {
  0:{good:"Correct. CSPM tools like AWS Config continuously evaluate resource configurations against security rules ‚Äî no attacker activity required. IDS, SIEM, and EDR all react to malicious activity; CSPM proactively checks configuration state.",bad:"Not quite. IDS, SIEM, and EDR all react to events. CSPM proactively checks configuration state ‚Äî no breach needs to occur for a finding to fire."},
  1:{good:"Correct. Layer 2 (Configuration Timeline) stores every configuration change with a timestamp and the IAM identity that made it ‚Äî exactly what you need for forensic investigation.",bad:"Not quite. Layer 1 gives current state snapshots. Layer 3 evaluates compliance. Layer 2 ‚Äî the Configuration Timeline ‚Äî stores historical changes with timestamps and IAM identity."},
  2:{good:"Correct. Enforcing a specific tag value matching an internal policy typically requires a custom Lambda rule with exact logic for that key/value combination.",bad:"Not quite. While AWS has a required-tags managed rule, enforcing a specific value like 'Confidential' for an internal data classification policy requires a custom Lambda with precise logic."},
  3:{good:"Correct. Suppress with documented justification ‚Äî 'Intentional: public S3 bucket for marketing website, reviewed [date].' This creates an auditable record of a deliberate decision.",bad:"Not quite. Ignoring leaves an unexplained finding in your audit trail. Disabling the rule removes protection for all other buckets too. Suppress with justification is the right path."}
};

let state = loadState();

function loadState(){
  try{const s=localStorage.getItem(STORAGE_KEY);if(s)return JSON.parse(s);}catch(e){}
  return{current:0,done:[],correct:[],answered:[],checks:[]};
}
function saveState(){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(state));}catch(e){}}

function goTo(n){
  document.querySelectorAll('.lesson-pane').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active'));
  state.current=n;
  document.getElementById('pane-'+(n===TOTAL?'complete':n)).classList.add('active');
  const items=document.querySelectorAll('.nav-item');
  if(items[n])items[n].classList.add('active');
  document.getElementById('topbar-title').textContent=titles[n]||'Complete';
  document.getElementById('btn-prev').disabled=(n===0);
  document.getElementById('btn-next').disabled=(n>=TOTAL-1);
  window.scrollTo(0,0);saveState();updateProgress();
}
function next(){if(state.current<TOTAL-1)goTo(state.current+1);}
function prev(){if(state.current>0)goTo(state.current-1);}

function finish(){
  markDone(state.current);
  document.querySelectorAll('.lesson-pane').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active'));
  const pct=Math.round(state.correct.length/4*100);
  document.getElementById('score-val').textContent=state.correct.length+' / 4 ('+pct+'%)';
  const checked=state.checks.filter(Boolean).length;
  document.getElementById('lab-score-val').textContent=checked+' / 8';
  document.getElementById('pane-complete').classList.add('active');
  document.getElementById('topbar-title').textContent='Complete';
  document.getElementById('btn-prev').disabled=true;
  document.getElementById('btn-next').disabled=true;
  saveState();
}

function markDone(n){
  if(!state.done.includes(n))state.done.push(n);
  const items=document.querySelectorAll('.nav-item');
  if(items[n])items[n].classList.add('done');
  updateProgress();
}
function updateProgress(){
  const c=state.done.length;
  document.getElementById('progress-pct').textContent=c+' / '+TOTAL;
  document.getElementById('progress-fill').style.width=(c/TOTAL*100)+'%';
}

function check(btn,isCorrect,idx){
  if(state.answered.includes(idx))return;
  state.answered.push(idx);
  const opts=btn.closest('.kcheck-options').querySelectorAll('.kcheck-opt');
  opts.forEach(o=>{o.classList.add('disabled');o.style.pointerEvents='none';});
  const fbEl=document.getElementById('fb-'+idx);
  if(isCorrect){
    btn.classList.add('correct');fbEl.className='kcheck-feedback show good';fbEl.textContent='‚úì '+fb[idx].good;
    if(!state.correct.includes(idx))state.correct.push(idx);
  } else {
    btn.classList.add('wrong');fbEl.className='kcheck-feedback show bad';fbEl.textContent='‚úó '+fb[idx].bad;
    opts.forEach(o=>{if(o.getAttribute('onclick')&&o.getAttribute('onclick').includes('true'))o.classList.add('reveal-correct');});
  }
  markDone(idx);saveState();
}

function toggleCheck(el,idx){
  if(!state.checks[idx])state.checks[idx]=false;
  state.checks[idx]=!state.checks[idx];
  el.classList.toggle('checked',state.checks[idx]);
  updateChecklist();saveState();
}
function updateChecklist(){
  const total=8,checked=state.checks.filter(Boolean).length;
  document.getElementById('cl-fill').style.width=(checked/total*100)+'%';
  document.getElementById('cl-label').textContent=checked+' / '+total;
  if(checked===total&&!state.done.includes(4))markDone(4);
}

function copyCode(btn){
  const pre=btn.closest('.code-block').querySelector('pre');
  navigator.clipboard.writeText(pre.innerText).then(()=>{btn.textContent='copied!';setTimeout(()=>btn.textContent='copy',1500);});
}

function resetAll(){
  state={current:0,done:[],correct:[],answered:[],checks:[]};saveState();
  document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('done'));
  document.querySelectorAll('.kcheck-opt').forEach(o=>{o.classList.remove('correct','wrong','reveal-correct','disabled');o.style.pointerEvents='';});
  document.querySelectorAll('.kcheck-feedback').forEach(f=>{f.className='kcheck-feedback';f.textContent='';});
  document.querySelectorAll('.check-item').forEach(i=>i.classList.remove('checked'));
  updateChecklist();updateProgress();goTo(0);
}

function restoreState(){
  state.done.forEach(n=>{const items=document.querySelectorAll('.nav-item');if(items[n])items[n].classList.add('done');});
  state.answered.forEach(idx=>{
    const paneEl=document.getElementById('pane-'+idx);if(!paneEl)return;
    const opts=paneEl.querySelectorAll('.kcheck-opt');
    opts.forEach(o=>{o.classList.add('disabled');o.style.pointerEvents='none';});
    const fbEl=document.getElementById('fb-'+idx);
    if(state.correct.includes(idx)){
      const co=Array.from(opts).find(o=>o.getAttribute('onclick')&&o.getAttribute('onclick').includes('true'));
      if(co)co.classList.add('correct');
      if(fbEl){fbEl.className='kcheck-feedback show good';fbEl.textContent='‚úì '+fb[idx].good;}
    } else {
      opts.forEach(o=>{if(o.getAttribute('onclick')&&o.getAttribute('onclick').includes('true'))o.classList.add('reveal-correct');});
      if(fbEl){fbEl.className='kcheck-feedback show bad';fbEl.textContent='‚úó '+fb[idx].bad;}
    }
  });
  state.checks.forEach((v,i)=>{
    if(v){const items=document.querySelectorAll('.check-item');if(items[i])items[i].classList.add('checked');}
  });
  updateChecklist();updateProgress();goTo(state.current||0);
}

restoreState();
</script>
</body>
</html>
