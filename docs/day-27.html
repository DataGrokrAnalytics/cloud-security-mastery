<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Day 27 ‚Äî Advanced Operations: ScoutSuite & Risk Prioritisation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root{--bg:#0d0f14;--surface:#13161d;--surface2:#181c26;--border:#1f2330;--border-hi:#2e3447;--text:#c8d0e0;--muted:#5a6178;--faint:#3a3f52;--accent:#f05a5a;--accent-dim:rgba(240,90,90,.08);--amber:#f0924a;--violet:#8a7fff;--danger:#f05a5a;--code-bg:#0a0c10;--pill:#1a1f2e;--lab:#f0c84a;--lab-dim:rgba(240,200,74,.08);--w4:#f05a5a;}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;font-weight:300;font-size:15px;line-height:1.75;min-height:100vh;overflow-x:hidden}
.shell{display:grid;grid-template-columns:268px 1fr;min-height:100vh}
.sidebar{background:var(--surface);border-right:1px solid var(--border);padding:32px 0;position:sticky;top:0;height:100vh;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-header{padding:0 24px 24px;border-bottom:1px solid var(--border)}
.day-badge{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.12em;text-transform:uppercase;color:var(--w4);margin-bottom:6px}
.sidebar-header h2{font-family:'DM Serif Display',serif;font-size:15px;font-weight:400;color:#e4eaf6;line-height:1.4}
.sidebar-meta{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
.chip{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.06em;background:var(--pill);color:var(--muted);padding:3px 8px;border-radius:3px}
.lesson-nav{padding:16px 0;flex:1}
.nav-group-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--faint);padding:10px 24px 6px}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 24px;cursor:pointer;transition:background .15s;border-left:2px solid transparent}
.nav-item:hover{background:rgba(255,255,255,.03)}
.nav-item.active{background:var(--accent-dim);border-left-color:var(--accent)}.nav-item.active .nav-label{color:var(--accent)}
.nav-item.lab-item.active{background:var(--lab-dim);border-left-color:var(--lab)}.nav-item.lab-item.active .nav-label{color:var(--lab)}
.nav-num{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);width:18px;flex-shrink:0;text-align:right}
.nav-label{font-size:12.5px;color:#8a92a8;line-height:1.3}
.nav-check{margin-left:auto;width:14px;height:14px;border-radius:50%;border:1px solid var(--border-hi);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:8px;color:transparent;transition:all .2s}
.nav-item.done .nav-check{background:var(--accent);border-color:var(--accent);color:var(--bg)}
.nav-item.lab-item.done .nav-check{background:var(--lab);border-color:var(--lab);color:var(--bg)}
.sidebar-footer{padding:20px 24px;border-top:1px solid var(--border);margin-top:auto}
.progress-label{display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-bottom:8px}
.progress-bar{height:3px;background:var(--border);border-radius:2px;overflow:hidden}
.progress-fill{height:100%;background:var(--accent);border-radius:2px;transition:width .4s ease;width:0%}
.main{display:flex;flex-direction:column}
.lesson-topbar{display:flex;align-items:center;justify-content:space-between;padding:16px 48px;border-bottom:1px solid var(--border);background:var(--surface);position:sticky;top:0;z-index:10}
.lesson-crumb{font-family:'IBM Plex Mono',monospace;font-size:11px;color:var(--muted)}.lesson-crumb span{color:var(--text)}
.nav-arrows{display:flex;gap:8px}
.arrow-btn{background:var(--pill);border:1px solid var(--border-hi);color:var(--muted);border-radius:5px;padding:5px 12px;font-size:12px;cursor:pointer;font-family:'IBM Plex Mono',monospace;transition:all .15s}
.arrow-btn:hover:not(:disabled){border-color:var(--accent);color:var(--accent)}.arrow-btn:disabled{opacity:.3;cursor:default}
.lesson-pane{display:none;flex-direction:column;padding:56px 48px 80px;max-width:760px;animation:fadeIn .3s ease}
.lesson-pane.active{display:flex}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.lesson-tag{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.12em;text-transform:uppercase;margin-bottom:14px}
.tag-concept{color:var(--violet)}.tag-warning{color:var(--amber)}.tag-security{color:var(--accent)}.tag-lab{color:var(--lab)}.tag-arch{color:#4ab8d4}.tag-detect{color:var(--w4)}
.lesson-pane h1{font-family:'DM Serif Display',serif;font-size:28px;font-weight:400;line-height:1.25;color:#e8eef8;margin-bottom:24px}
.lesson-pane h1 em{font-style:italic;color:var(--accent)}.lab-pane h1 em{color:var(--lab)}
.lesson-pane h2{font-family:'DM Serif Display',serif;font-size:20px;font-weight:400;color:#e4eaf6;margin:32px 0 14px}
.lesson-pane p{color:var(--text);margin-bottom:18px;font-size:15px}
.lesson-pane strong{color:#e0e6f0;font-weight:500}
.lesson-pane ul,ol{padding-left:20px;margin-bottom:18px;color:#a0a8bc;line-height:1.9}
.lesson-pane li{margin-bottom:4px}
.callout{border-left:3px solid;padding:16px 20px;border-radius:0 6px 6px 0;margin:24px 0;font-size:14px;line-height:1.7}
.callout-title{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.1em;text-transform:uppercase;margin-bottom:8px;font-weight:600}
.callout.breach{border-color:var(--danger);background:rgba(240,90,90,.06)}.callout.breach .callout-title{color:var(--danger)}
.callout.insight{border-color:var(--violet);background:rgba(138,127,255,.06)}.callout.insight .callout-title{color:var(--violet)}
.callout.tip{border-color:var(--accent);background:var(--accent-dim)}.callout.tip .callout-title{color:var(--accent)}
.callout.warning{border-color:var(--amber);background:rgba(240,146,74,.06)}.callout.warning .callout-title{color:var(--amber)}
.callout.lab-note{border-color:var(--lab);background:var(--lab-dim)}.callout.lab-note .callout-title{color:var(--lab)}
.styled-table{width:100%;border-collapse:collapse;margin:24px 0;font-size:13.5px}
.styled-table th{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;color:var(--muted);text-align:left;padding:10px 16px;border-bottom:1px solid var(--border);background:var(--surface)}
.styled-table td{padding:11px 16px;border-bottom:1px solid var(--border);color:var(--text);vertical-align:top}
.styled-table tr:hover td{background:rgba(255,255,255,.02)}
.styled-table td:first-child{font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--w4)}
.code-block{background:var(--code-bg);border:1px solid var(--border);border-radius:6px;margin:20px 0;overflow:hidden}
.code-header{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;border-bottom:1px solid var(--border);background:rgba(255,255,255,.02)}
.code-lang{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:.06em;color:var(--muted);text-transform:uppercase}
.copy-btn{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);background:transparent;border:1px solid var(--border-hi);border-radius:3px;padding:2px 8px;cursor:pointer;transition:all .15s}
.copy-btn:hover{color:var(--accent);border-color:var(--accent)}
.code-block pre{font-family:'IBM Plex Mono',monospace;font-size:12.5px;line-height:1.8;padding:16px 20px;color:#a8b4cc;overflow-x:auto}
.code-block pre .hl{color:var(--w4)}.code-block pre .hl2{color:var(--amber)}.code-block pre .str{color:#7ec88c}.code-block pre .comment{color:var(--muted)}.code-block pre .key{color:#f0c84a}
.metrics-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:24px 0}
.metric-card{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:16px}
.metric-name{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);margin-bottom:6px;letter-spacing:.06em}
.metric-value{font-family:'IBM Plex Mono',monospace;font-size:18px;color:var(--w4);font-weight:600;margin-bottom:4px}
.metric-target{font-size:12px;color:var(--faint)}
.kcheck{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:28px 28px 24px;margin:36px 0 24px}
.kcheck-label{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--w4);margin-bottom:14px}
.kcheck-q{font-size:15px;color:#d0d8ec;font-weight:500;margin-bottom:20px;line-height:1.5}
.kcheck-options{display:flex;flex-direction:column;gap:10px}
.kcheck-opt{background:var(--surface2);border:1px solid var(--border-hi);border-radius:7px;padding:12px 16px;cursor:pointer;font-size:13.5px;color:#9aa3ba;line-height:1.5;text-align:left;transition:all .15s}
.kcheck-opt:hover:not(.disabled){border-color:var(--w4);color:var(--text);background:rgba(240,90,90,.06)}
.kcheck-opt.correct{border-color:#3ecfcf;background:rgba(62,207,207,.08);color:#3ecfcf}
.kcheck-opt.wrong{border-color:var(--danger);background:rgba(240,90,90,.08);color:var(--danger)}
.kcheck-opt.reveal-correct{border-color:#3ecfcf;background:rgba(62,207,207,.06);color:#3ecfcf;opacity:.7}
.kcheck-opt.disabled{cursor:default}
.kcheck-feedback{font-size:13px;line-height:1.6;padding:12px 14px;border-radius:6px;margin-top:12px;display:none}
.kcheck-feedback.show{display:block}
.kcheck-feedback.good{background:rgba(62,207,207,.08);color:#3ecfcf;border:1px solid rgba(62,207,207,.2)}
.kcheck-feedback.bad{background:rgba(240,90,90,.07);color:#f08080;border:1px solid rgba(240,90,90,.2)}
.lab-steps{display:flex;flex-direction:column;gap:0;margin:24px 0}
.lab-step{display:flex;gap:20px;position:relative}
.step-num-wrap{display:flex;flex-direction:column;align-items:center;flex-shrink:0}
.step-num{width:32px;height:32px;border-radius:50%;background:var(--lab-dim);border:1px solid rgba(240,200,74,.3);display:flex;align-items:center;justify-content:center;font-family:'IBM Plex Mono',monospace;font-size:12px;font-weight:600;color:var(--lab);flex-shrink:0}
.step-connector{width:1px;background:var(--border);flex:1;margin:4px 0;min-height:24px}
.step-content{flex:1;padding-bottom:32px}
.step-title{font-family:'IBM Plex Mono',monospace;font-size:12px;font-weight:600;color:var(--text);margin-bottom:12px;letter-spacing:.02em}
.step-body{font-size:14px;color:#9aa3ba;line-height:1.7}
.step-body ol,.step-body ul{padding-left:18px;margin:8px 0}
.step-body li{margin-bottom:6px}
.step-body p{margin-bottom:12px}
.step-body code{font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 6px;border-radius:3px;color:#c8d0e0}
.checklist{display:flex;flex-direction:column;gap:8px;margin:20px 0 32px}
.check-item{display:flex;align-items:flex-start;gap:14px;padding:12px 16px;background:var(--surface);border:1px solid var(--border);border-radius:7px;cursor:pointer;transition:border-color .15s}
.check-item:hover{border-color:var(--border-hi)}
.check-item.checked{border-color:rgba(240,200,74,.3);background:var(--lab-dim)}
.check-box{width:18px;height:18px;border-radius:4px;border:1px solid var(--border-hi);flex-shrink:0;margin-top:1px;display:flex;align-items:center;justify-content:center;font-size:11px;color:transparent;transition:all .2s}
.check-item.checked .check-box{background:var(--lab);border-color:var(--lab);color:var(--bg)}
.check-text{font-size:13.5px;color:#9aa3ba;line-height:1.5}
.check-text code{font-family:'IBM Plex Mono',monospace;font-size:11.5px;background:var(--pill);padding:1px 5px;border-radius:3px;color:#c8d0e0}
.checklist-progress{display:flex;align-items:center;gap:14px;margin-bottom:12px}
.checklist-progress-bar{flex:1;height:3px;background:var(--border);border-radius:2px;overflow:hidden}
.checklist-progress-fill{height:100%;background:var(--lab);border-radius:2px;transition:width .4s ease;width:0%}
.checklist-progress-label{font-family:'IBM Plex Mono',monospace;font-size:10px;color:var(--muted);white-space:nowrap}
.lesson-nav-footer{display:flex;gap:12px;margin-top:40px;padding-top:28px;border-top:1px solid var(--border)}
.prev-btn,.next-btn{font-family:'IBM Plex Mono',monospace;font-size:11px;letter-spacing:.04em;padding:10px 22px;border-radius:6px;cursor:pointer;transition:all .15s}
.prev-btn{background:transparent;border:1px solid var(--border-hi);color:var(--muted)}.prev-btn:hover{color:var(--text);border-color:var(--text)}
.next-btn{background:var(--accent);border:1px solid var(--accent);color:#fff;font-weight:600}.next-btn:hover{opacity:.85}
.lab-btn{background:var(--lab);border-color:var(--lab);color:#0d0f14}
.completion-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:48px;text-align:center;max-width:520px;margin:0 auto}
.completion-icon{font-size:48px;display:block;margin-bottom:20px}
.completion-card h1{font-family:'DM Serif Display',serif;font-size:28px;font-weight:400;color:#e8eef8;margin-bottom:14px}
.completion-card p{font-size:14px;color:#6a7490;line-height:1.7;margin-bottom:24px}
.score-pill{display:inline-flex;align-items:center;gap:8px;background:rgba(240,90,90,.1);border:1px solid rgba(240,90,90,.2);border-radius:20px;padding:7px 18px;font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--w4)}
.lab-score-pill{display:inline-flex;align-items:center;gap:8px;background:var(--lab-dim);border:1px solid rgba(240,200,74,.2);border-radius:20px;padding:7px 18px;font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--lab)}
@media(max-width:768px){.shell{grid-template-columns:1fr}.sidebar{display:none}.lesson-pane{padding:32px 20px 60px}.lesson-topbar{padding:14px 20px}.metrics-grid{grid-template-columns:1fr 1fr}}
</style>
</head>
<body>
<div class="shell">
<aside class="sidebar">
  <div class="sidebar-header">
    <div class="day-badge">Week 4 ¬∑ Day 27</div>
    <h2>Advanced Operations: ScoutSuite & Risk Prioritisation</h2>
    <div class="sidebar-meta"><span class="chip">Advanced</span><span class="chip">4 hours</span><span class="chip">ScoutSuite</span></div>
  </div>
  <nav class="lesson-nav">
    <div class="nav-group-label">Lessons</div>
    <div class="nav-item active" onclick="goTo(0)"><span class="nav-num">1</span><span class="nav-label">Why External Assessment Tools</span><span class="nav-check">‚úì</span></div>
    <div class="nav-item" onclick="goTo(1)"><span class="nav-num">2</span><span class="nav-label">Risk Prioritisation: The Business Layer</span><span class="nav-check">‚úì</span></div>
    <div class="nav-item" onclick="goTo(2)"><span class="nav-num">3</span><span class="nav-label">Threat Hunting: Proactive Detection</span><span class="nav-check">‚úì</span></div>
    <div class="nav-item" onclick="goTo(3)"><span class="nav-num">4</span><span class="nav-label">Metrics That Matter to a CISO</span><span class="nav-check">‚úì</span></div>
    <div class="nav-group-label">Lab</div>
    <div class="nav-item lab-item" onclick="goTo(4)"><span class="nav-num">5</span><span class="nav-label">Hands-on: ScoutSuite + Risk Matrix</span><span class="nav-check">‚úì</span></div>
  </nav>
  <div class="sidebar-footer">
    <div class="progress-label"><span>Day progress</span><span id="progress-pct">0 / 5</span></div>
    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
  </div>
</aside>
<main class="main">
  <div class="lesson-topbar">
    <div class="lesson-crumb">Week 4 &nbsp;/&nbsp; <span id="topbar-title">Why External Assessment Tools</span></div>
    <div class="nav-arrows">
      <button class="arrow-btn" id="btn-prev" onclick="prev()" disabled>‚Üê Prev</button>
      <button class="arrow-btn" id="btn-next" onclick="next()">Next ‚Üí</button>
    </div>
  </div>

  <!-- PANE 0 -->
  <div class="lesson-pane active" id="pane-0">
    <div class="lesson-tag tag-detect">üî≠ External View</div>
    <h1>Why External<br><em>Assessment Tools</em></h1>
    <p>AWS-native tools ‚Äî Config, Security Hub, GuardDuty ‚Äî are excellent, but they share one characteristic: they're operated by the same team that built and configured the environment. When a misconfiguration exists, the native tools may be configured to suppress or ignore it ‚Äî often for legitimate reasons, but sometimes by accident or habit.</p>
    <p>An external assessment tool like <strong>ScoutSuite</strong> runs independently of your AWS console configuration. It makes direct API calls to enumerate resources and checks them against a comprehensive ruleset that the security community has validated. It finds things that:</p>
    <ul>
      <li>Were suppressed in Security Hub but are still real issues</li>
      <li>Exist in services not covered by your active Config rules</li>
      <li>Are security concerns AWS doesn't flag as non-compliant but practitioners consider risky</li>
      <li>Your team normalised and stopped noticing</li>
    </ul>
    <div class="callout insight">
      <div class="callout-title">üí° ScoutSuite Context</div>
      ScoutSuite is open-source, maintained by NCC Group, and widely used in penetration testing and security assessments. Running it gives you the perspective of an external assessor ‚Äî the same kind of report a pen tester would produce. Finding gaps now is better than a client or a regulator finding them.
    </div>
    <div class="callout tip">
      <div class="callout-title">üîç What ScoutSuite Checks That Config Doesn't</div>
      ScoutSuite assesses 200+ checks across IAM, S3, EC2, RDS, CloudTrail, Lambda, and more ‚Äî including checks for weak password policies, unused regions with services running, API Gateway configurations, and resource tagging gaps that AWS Config's default managed rules don't cover.
    </div>
    <div class="kcheck" id="pane-0-quiz">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Your Security Hub shows 0 critical findings. A ScoutSuite assessment finds 3 critical issues. Which scenario best explains this discrepancy?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,0)">ScoutSuite is producing false positives ‚Äî Security Hub is more accurate because it's AWS-native.</button>
        <button class="kcheck-opt" onclick="check(this,false,0)">Security Hub covers more checks than ScoutSuite so the findings would be duplicated if both were shown.</button>
        <button class="kcheck-opt" onclick="check(this,true,0)">The 3 issues may be in services or patterns not covered by your active Security Hub standards, or were previously suppressed ‚Äî ScoutSuite's independent ruleset surfaces gaps the native tooling missed.</button>
        <button class="kcheck-opt" onclick="check(this,false,0)">ScoutSuite and Security Hub use different severity scales so a ScoutSuite Critical equals a Security Hub Medium.</button>
      </div>
      <div class="kcheck-feedback" id="fb-0"></div>
    </div>
    <div class="lesson-nav-footer"><button class="prev-btn" onclick="prev()" disabled>‚Üê Previous</button><button class="next-btn" onclick="next()">Next ‚Üí</button></div>
  </div>

  <!-- PANE 1 -->
  <div class="lesson-pane" id="pane-1">
    <div class="lesson-tag tag-concept">üìä Business Context</div>
    <h1>Risk Prioritisation:<br><em>The Business Layer</em></h1>
    <p>Technical findings without business context are incomplete. A Critical CVE on a development instance with no sensitive data is objectively lower priority than a Medium misconfiguration on your payment processing service.</p>
    <p>Risk prioritisation adds two dimensions to finding severity: <strong>asset criticality</strong> and <strong>exploitability in your environment</strong>.</p>
    <h2>Asset Criticality Tiers</h2>
    <table class="styled-table">
      <thead><tr><th>Tier</th><th>Description</th><th>Score</th></tr></thead>
      <tbody>
        <tr><td>Tier 1</td><td>Production services handling customer data or payments</td><td>4</td></tr>
        <tr><td>Tier 2</td><td>Production services with no customer data</td><td>3</td></tr>
        <tr><td>Tier 3</td><td>Staging and pre-production</td><td>2</td></tr>
        <tr><td>Tier 4</td><td>Development and sandbox</td><td>1</td></tr>
      </tbody>
    </table>
    <p>The adjusted risk score multiplies finding severity by asset criticality: <code>Adjusted Risk = Severity √ó Asset Tier</code></p>
    <p>A Critical (4) finding on a Tier 4 dev instance = adjusted score 4. A Medium (2) finding on a Tier 1 production service = adjusted score 8. The Medium finding on production is twice as urgent despite being lower severity.</p>
    <div class="callout insight">
      <div class="callout-title">üí° The Business Conversation</div>
      This is the framework that lets security teams talk to engineering and business leadership in terms they care about. Not "we have 300 findings" ‚Äî but "we have 3 findings on Tier 1 services reachable from the internet, with an adjusted score above 10 each, that need to be resolved this sprint."
    </div>
    <div class="kcheck" id="pane-1-quiz">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Finding A: High severity (3) unpatched CVE on a Tier 4 sandbox EC2 instance with no internet access. Finding B: Medium severity (2) public S3 bucket on a Tier 1 production service storing audit logs. Which has the higher adjusted risk score and should be prioritised first?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,1)">Finding A ‚Äî High severity always outranks Medium severity regardless of asset context.</button>
        <button class="kcheck-opt" onclick="check(this,true,1)">Finding B ‚Äî Adjusted scores: A = 3√ó1 = 3, B = 2√ó4 = 8. The public production bucket has 2.5√ó higher adjusted risk despite lower severity.</button>
        <button class="kcheck-opt" onclick="check(this,false,1)">They are equal ‚Äî CVEs and misconfigurations cannot be compared on the same risk scale.</button>
        <button class="kcheck-opt" onclick="check(this,false,1)">Finding A ‚Äî CVEs are always higher priority than configuration findings because they have CVSS scores.</button>
      </div>
      <div class="kcheck-feedback" id="fb-1"></div>
    </div>
    <div class="lesson-nav-footer"><button class="prev-btn" onclick="prev()">‚Üê Previous</button><button class="next-btn" onclick="next()">Next ‚Üí</button></div>
  </div>

  <!-- PANE 2 -->
  <div class="lesson-pane" id="pane-2">
    <div class="lesson-tag tag-security">üîç Proactive Detection</div>
    <h1>Threat Hunting:<br><em>Proactive Detection</em></h1>
    <p>Threat hunting is the practice of proactively searching for attacker behaviour that automated detection hasn't flagged. You're not waiting for GuardDuty to alert you ‚Äî you're actively looking for signs of compromise using a <strong>specific hypothesis</strong>.</p>
    <p>A hunt without a hypothesis is just log browsing. A good hypothesis is: "I think an attacker might be using IAM credentials from an unusual geographic location" ‚Äî then you query logs to confirm or rule it out.</p>
    <h2>Three High-Value AWS Hunt Queries</h2>
    <div class="code-block"><div class="code-header"><span class="code-lang">CloudWatch Logs Insights ‚Äî Hunt 1: Unusual source IPs for IAM actions</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div><pre>fields eventTime, userIdentity.arn, eventName, sourceIPAddress
| filter eventSource = <span class="str">"iam.amazonaws.com"</span>
    and not sourceIPAddress like <span class="str">/AWS Internal/</span>
| stats count(*) as callCount by sourceIPAddress, userIdentity.arn
| sort callCount desc
| limit 15</pre></div>
    <div class="code-block"><div class="code-header"><span class="code-lang">CloudWatch Logs Insights ‚Äî Hunt 2: API calls generating errors (recon signal)</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div><pre>fields eventTime, userIdentity.arn, eventName, errorCode, sourceIPAddress
| filter ispresent(errorCode)
    and errorCode != <span class="str">"NoSuchEntityException"</span>
| stats count(*) as errorCount by sourceIPAddress, errorCode
| sort errorCount desc
| limit 15</pre></div>
    <div class="code-block"><div class="code-header"><span class="code-lang">CloudWatch Logs Insights ‚Äî Hunt 3: IAM changes outside business hours</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div><pre>fields eventTime, eventName, userIdentity.arn
| filter eventSource = <span class="str">"iam.amazonaws.com"</span>
    and (ispresent(errorCode) = 0)
| parse eventTime <span class="str">/(?&lt;hour&gt;\d{2}):\d{2}:\d{2}Z/</span>
| filter hour &lt; 8 or hour &gt; 18
| sort eventTime desc</pre></div>
    <div class="callout warning">
      <div class="callout-title">‚ö†Ô∏è Context Is Everything</div>
      An IAM action at 2am from an IP in another country is suspicious ‚Äî but it might be a developer in that country, or a scheduled job. Never treat a hunt result as confirmed malicious activity. It's a lead for investigation, not a verdict. Cross-reference with HR records, on-call schedules, and deployment logs before taking action.
    </div>
    <div class="kcheck" id="pane-2-quiz">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Hunt 2 returns: <code>sourceIPAddress=198.51.100.42, errorCode=AccessDenied, errorCount=847</code> in the last hour. What is the most accurate interpretation of this result?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,2)">Confirmed attack ‚Äî 847 AccessDenied errors from a single IP is definitively malicious activity requiring immediate incident response.</button>
        <button class="kcheck-opt" onclick="check(this,false,2)">This is normal ‚Äî high AccessDenied counts from a single IP are common and can be safely ignored.</button>
        <button class="kcheck-opt" onclick="check(this,true,2)">This is a high-priority lead requiring investigation ‚Äî it could be credential stuffing, permission misconfiguration on a legitimate service, or a misconfigured application. Check CloudTrail for which API calls are failing and what identity is making them before concluding it's an attack.</button>
        <button class="kcheck-opt" onclick="check(this,false,2)">Block the IP address immediately ‚Äî 847 errors in one hour crosses the automatic-block threshold.</button>
      </div>
      <div class="kcheck-feedback" id="fb-2"></div>
    </div>
    <div class="lesson-nav-footer"><button class="prev-btn" onclick="prev()">‚Üê Previous</button><button class="next-btn" onclick="next()">Next ‚Üí</button></div>
  </div>

  <!-- PANE 3 -->
  <div class="lesson-pane" id="pane-3">
    <div class="lesson-tag tag-arch">üìà Reporting</div>
    <h1>Metrics That<br><em>Matter to a CISO</em></h1>
    <p>By the time you brief security posture to a CISO or leadership, you need to translate technical findings into business metrics. Six numbers tell a CISO more about security operations maturity than a 300-item finding list.</p>
    <div class="metrics-grid">
      <div class="metric-card"><div class="metric-name">MTTD</div><div class="metric-value">&lt;1h</div><div class="metric-target">Mean Time to Detect ‚Äî HIGH findings</div></div>
      <div class="metric-card"><div class="metric-name">MTTR (manual)</div><div class="metric-value">&lt;4h</div><div class="metric-target">Mean Time to Respond ‚Äî HIGH</div></div>
      <div class="metric-card"><div class="metric-name">MTTR (SOAR)</div><div class="metric-value">&lt;30s</div><div class="metric-target">Automated finding types</div></div>
      <div class="metric-card"><div class="metric-name">Patch SLA</div><div class="metric-value">&gt;95%</div><div class="metric-target">CVEs patched within SLA window</div></div>
      <div class="metric-card"><div class="metric-name">Open Critical &gt;7d</div><div class="metric-value">0</div><div class="metric-target">Findings breaching SLA</div></div>
      <div class="metric-card"><div class="metric-name">CIS Score</div><div class="metric-value">&gt;85%</div><div class="metric-target">Benchmark compliance target</div></div>
    </div>
    <div class="callout insight">
      <div class="callout-title">üí° Trend Matters More Than Snapshot</div>
      A single snapshot of these metrics tells you current state. The <em>trend</em> over time tells you whether your security programme is improving or degrading. A CIS score of 78% improving from 35% over 4 weeks is a stronger story than a static 85% with no trend data.
    </div>
    <p>When presenting to leadership, lead with outcomes, not tools. Don't say "I enabled GuardDuty" ‚Äî say "I reduced mean time to detect credential compromise from days to minutes, and automated response to our most common finding type brings MTTR from hours to under 30 seconds."</p>
    <div class="kcheck" id="pane-3-quiz">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">At your monthly security review, you report: MTTD = 45 minutes, MTTR = 2 hours, 0 open critical findings older than 7 days, CIS score = 81%. Your manager asks "are we secure?" What is the most accurate and honest response?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,3)">Yes ‚Äî all metrics are within target so the environment is secure.</button>
        <button class="kcheck-opt" onclick="check(this,false,3)">No ‚Äî the CIS score is below 85% which means the environment fails the security benchmark.</button>
        <button class="kcheck-opt" onclick="check(this,true,3)">These metrics show strong security operations maturity ‚Äî detection, response, and posture are all within target. But "secure" is never a final state: new threats emerge, new services are deployed, and the metrics need to be maintained. The residual risks identified in our threat model are the current known gaps.</button>
        <button class="kcheck-opt" onclick="check(this,false,3)">The metrics don't indicate anything meaningful about security ‚Äî you would need a penetration test to determine if the environment is secure.</button>
      </div>
      <div class="kcheck-feedback" id="fb-3"></div>
    </div>
    <div class="lesson-nav-footer"><button class="prev-btn" onclick="prev()">‚Üê Previous</button><button class="next-btn" onclick="next()">Next ‚Üí</button></div>
  </div>

  <!-- PANE 4 ‚Äî Lab -->
  <div class="lesson-pane lab-pane" id="pane-4">
    <div class="lesson-tag tag-lab">üî¨ Hands-on Lab</div>
    <h1>ScoutSuite +<br><em>Risk Matrix</em></h1>
    <p>Run an independent ScoutSuite assessment, build a business-contextualised risk prioritisation matrix, and run two threat hunting queries against your CloudTrail logs.</p>
    <div class="callout lab-note"><div class="callout-title">‚ö° No AWS Cost</div>ScoutSuite makes read-only API calls ‚Äî no resources are created or modified. No AWS cost today.</div>
    <div class="lab-steps">
      <div class="lab-step">
        <div class="step-num-wrap"><div class="step-num">1</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Install and Run ScoutSuite <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~25 min</span></div>
          <div class="step-body">
            <div class="code-block"><div class="code-header"><span class="code-lang">bash</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div><pre><span class="comment"># Install ScoutSuite</span>
pip3 install scoutsuite --break-system-packages

scout --version

<span class="comment"># Run the assessment (5-15 min)</span>
scout aws \
  --report-dir /tmp/scoutsuite-report \
  --no-browser

echo <span class="str">"‚úÖ Assessment complete"</span>
ls /tmp/scoutsuite-report/scoutsuite-results/</pre></div>
            <p>Open the HTML report in your browser ‚Äî navigate to IAM, S3, and CloudTrail sections. Note the top 5 findings ScoutSuite flags that Security Hub did not.</p>
          </div>
        </div>
      </div>
      <div class="lab-step">
        <div class="step-num-wrap"><div class="step-num">2</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Build the Risk Prioritisation Matrix <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~20 min</span></div>
          <div class="step-body">
            <p>Create <code>portfolio/week-4/risk-prioritisation-matrix.md</code>. Take your top 10 findings from ScoutSuite + Security Hub and score them:</p>
            <div class="code-block"><div class="code-header"><span class="code-lang">markdown template</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div><pre><span class="comment"># Risk Prioritisation Matrix</span>

<span class="comment">## Scoring: Severity (Crit=4/Hi=3/Med=2/Lo=1) √ó Asset Tier (T1=4/T2=3/T3=2/T4=1)</span>

<span class="key">| Finding | Source | Sev | Resource | Tier | Adj | Action | Due |</span>
<span class="key">|---------|--------|-----|----------|------|-----|--------|-----|</span>
| IAM user without MFA | Security Hub | 3 | [user] | T1 | 12 | Enable MFA | Today |
| S3 no block public access | ScoutSuite | 3 | [bucket]| T2 | 9 | Enable BPA | Today |
| CloudTrail log validation off | ScoutSuite | 2 | [trail] | T1 | 8 | Enable | Week |

<span class="comment">## Security Metrics Snapshot</span>

<span class="key">| Metric | Value | Target |</span>
<span class="key">|--------|-------|--------|</span>
| CIS Score | ___% | >85% |
| Open Critical Findings | ___ | 0 |
| Open High >7 days | ___ | 0 |
| SOAR Coverage | ___% | >30% |</pre></div>
          </div>
        </div>
      </div>
      <div class="lab-step">
        <div class="step-num-wrap"><div class="step-num">3</div></div>
        <div class="step-content">
          <div class="step-title">Run Two Threat Hunting Queries &amp; Commit <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~15 min</span></div>
          <div class="step-body">
            <p>CloudWatch ‚Üí <strong>Logs Insights</strong> ‚Üí log group <code>CloudTrail/ManagementEvents</code> ‚Üí run Hunt 1 and Hunt 2 from Lesson 3. Screenshot both results. Note any unexpected source IPs or error spikes.</p>
            <div class="code-block"><div class="code-header"><span class="code-lang">bash ‚Äî commit</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div><pre>cp -r /tmp/scoutsuite-report/ ~/cloud-security-mastery/portfolio/week-4/scoutsuite-report/ 2>/dev/null || true

git add portfolio/week-4/risk-prioritisation-matrix.md \
        portfolio/week-4/scoutsuite-report/ \
        screenshots/day-27-*.png
git commit -m <span class="str">"Day 27: ScoutSuite assessment, risk prioritisation matrix, threat hunting queries"</span>
git push</pre></div>
          </div>
        </div>
      </div>
    </div>
    <h2 style="font-family:'DM Serif Display',serif;font-size:20px;color:#e4eaf6;margin:32px 0 16px;font-weight:400">Lab Checklist</h2>
    <div class="checklist-progress"><div class="checklist-progress-bar"><div class="checklist-progress-fill" id="cl-fill"></div></div><span class="checklist-progress-label" id="cl-label">0 / 7</span></div>
    <div class="checklist">
      <div class="check-item" onclick="toggleCheck(this,0)"><div class="check-box">‚úì</div><div class="check-text">ScoutSuite installed and run successfully ‚Äî HTML report opened and reviewed</div></div>
      <div class="check-item" onclick="toggleCheck(this,1)"><div class="check-box">‚úì</div><div class="check-text">Top 5 ScoutSuite findings that Security Hub did NOT flag ‚Äî noted and compared</div></div>
      <div class="check-item" onclick="toggleCheck(this,2)"><div class="check-box">‚úì</div><div class="check-text">Risk prioritisation matrix created with 10 findings ‚Äî adjusted scores calculated</div></div>
      <div class="check-item" onclick="toggleCheck(this,3)"><div class="check-box">‚úì</div><div class="check-text">Top 3 priority actions identified by adjusted score</div></div>
      <div class="check-item" onclick="toggleCheck(this,4)"><div class="check-box">‚úì</div><div class="check-text">Security metrics snapshot completed in the matrix</div></div>
      <div class="check-item" onclick="toggleCheck(this,5)"><div class="check-box">‚úì</div><div class="check-text">Threat Hunt 1 (unusual source IPs) run ‚Äî results reviewed and screenshot taken</div></div>
      <div class="check-item" onclick="toggleCheck(this,6)"><div class="check-box">‚úì</div><div class="check-text">Threat Hunt 2 (AccessDenied recon signal) run ‚Äî results reviewed and committed</div></div>
    </div>
    <div class="lesson-nav-footer"><button class="prev-btn" onclick="prev()">‚Üê Previous</button><button class="next-btn lab-btn" onclick="finish()">Complete Day 27 ‚úì</button></div>
  </div>

  <!-- COMPLETION -->
  <div class="lesson-pane" id="pane-complete">
    <div class="completion-card">
      <span class="completion-icon">üî≠</span>
      <h1>Day 27 Complete</h1>
      <p>You now see your environment the way an external assessor does ‚Äî and you can explain risk in business language that leadership understands. One day left: the capstone. Tomorrow you assemble your complete portfolio, write the executive summary, and finalise 28 days of work.</p>
      <div class="score-pill"><span>‚ö°</span> Quiz: <span id="score-val">‚Äî</span></div><br>
      <div class="lab-score-pill"><span>üî¨</span> Lab: <span id="lab-score-val">‚Äî</span> / 7 complete</div>
      <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
        <a href="day-26.html" style="text-decoration:none"><button class="prev-btn">‚Üê Day 26</button></a>
        <a href="day-28.html" style="text-decoration:none"><button class="next-btn">Day 28 ‚Üí</button></a>
      </div>
    </div>
  </div>
</main>
</div>
<script>
const STORAGE_KEY='csm-day27';const TOTAL=5;
const titles=['Why External Assessment Tools','Risk Prioritisation: The Business Layer','Threat Hunting: Proactive Detection','Metrics That Matter to a CISO','Hands-on: ScoutSuite + Risk Matrix'];
const fb={
  0:{good:"Correct. Security Hub only surfaces findings from the standards and integrations you've enabled and configured. If a finding type isn't covered by an active rule, or was suppressed (intentionally or accidentally), Security Hub won't show it. ScoutSuite's independent ruleset operates outside this configuration ‚Äî it checks everything regardless of what's enabled in your console. The discrepancy reveals a real coverage gap, not a false positive problem.",bad:"Not quite. ScoutSuite is maintained by NCC Group and is widely used in professional penetration testing ‚Äî its findings are generally accurate. The more likely explanation for the discrepancy: the 3 issues are in service areas or patterns not covered by your active Security Hub standards, or were previously suppressed without documentation. AWS-native tools and independent assessment tools complement each other ‚Äî neither is universally more accurate."},
  1:{good:"Correct. Finding A adjusted score = High(3) √ó Tier4(1) = 3. Finding B adjusted score = Medium(2) √ó Tier1(4) = 8. Finding B has 2.5√ó the adjusted risk. A CVE on a sandbox with no internet access has very limited exploitability and negligible blast radius. A public S3 bucket on a Tier 1 production service storing audit logs is directly reachable from the internet, contains potentially sensitive data, and a breach could have compliance and reputational consequences. This is precisely why raw severity scores without business context lead to wrong prioritisation decisions.",bad:"Not quite. Raw severity scores (High > Medium) don't tell the whole story. Adjusted scores add asset criticality: Finding A = 3√ó1 = 3, Finding B = 2√ó4 = 8. The Medium finding on a Tier 1 production service has a higher adjusted risk than the High finding on a Tier 4 sandbox. A CVE on an isolated development machine with no internet access poses minimal exploitability and blast radius. A public production bucket is directly reachable and could expose audit logs to the internet. Business context changes the prioritisation."},
  2:{good:"Correct. 847 AccessDenied errors from a single IP in one hour is a strong signal that warrants investigation ‚Äî but 'warrants investigation' is not the same as 'confirmed attack.' It could be: credential stuffing (attacker trying stolen credentials), a misconfigured application that lost its IAM permissions, a developer testing access from an unusual location, or a legitimate service with a broken IAM policy. Check CloudTrail for which specific API calls are failing, which IAM identity is making them, and whether the pattern matches a known application deployment. Then escalate based on what you find.",bad:"Not quite. 847 AccessDenied errors from a single IP is a significant signal that demands investigation ‚Äî but jumping to 'confirmed attack requiring immediate incident response' without investigation risks a false positive response that could disrupt legitimate services. Equally, treating it as normal and ignoring it misses a real threat signal. And blocking the IP immediately without understanding what it is could break a legitimate application. The correct response is to treat it as a high-priority lead and investigate before concluding."},
  3:{good:"Correct. The metrics show genuine security operations maturity ‚Äî detection time, response time, open critical findings, and compliance score are all within target. But 'secure' is a continuous state, not a destination. The honest and complete answer acknowledges what the metrics show, contextualises them against the residual risks from the threat model (the known gaps), and frames security as an ongoing programme rather than a checked box. This is the kind of nuanced answer that builds leadership trust.",bad:"Not quite. Metrics within target don't mean the environment is 'secure' in an absolute sense ‚Äî they mean the security programme is operating effectively against known threat patterns. But the threat landscape evolves, new services get deployed, and the residual risks from the threat model (WAF gap, no internal TLS on DB traffic) remain. The CIS score being slightly below target (81% vs 85%) is not a failure ‚Äî it's a gap to close. A penetration test complements metrics but doesn't replace them. The complete answer acknowledges both the strong posture and the remaining known gaps."}
};
let state=loadState();
function loadState(){try{const s=localStorage.getItem(STORAGE_KEY);if(s)return JSON.parse(s);}catch(e){}return{current:0,done:[],correct:[],answered:[],checks:[]};}
function saveState(){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(state));}catch(e){}}
function goTo(n){document.querySelectorAll('.lesson-pane').forEach(p=>p.classList.remove('active'));document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active'));state.current=n;document.getElementById('pane-'+(n===TOTAL?'complete':n)).classList.add('active');const items=document.querySelectorAll('.nav-item');if(items[n])items[n].classList.add('active');document.getElementById('topbar-title').textContent=titles[n]||'Complete';document.getElementById('btn-prev').disabled=(n===0);document.getElementById('btn-next').disabled=(n>=TOTAL-1);window.scrollTo(0,0);saveState();updateProgress();}
function next(){if(state.current<TOTAL-1)goTo(state.current+1);}function prev(){if(state.current>0)goTo(state.current-1);}
function finish(){markDone(state.current);document.querySelectorAll('.lesson-pane').forEach(p=>p.classList.remove('active'));document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('active'));const pct=Math.round(state.correct.length/4*100);document.getElementById('score-val').textContent=state.correct.length+' / 4 ('+pct+'%)';const checked=state.checks.filter(Boolean).length;document.getElementById('lab-score-val').textContent=checked;document.getElementById('pane-complete').classList.add('active');document.getElementById('btn-prev').disabled=true;document.getElementById('btn-next').disabled=true;saveState();}
function markDone(n){if(!state.done.includes(n))state.done.push(n);const items=document.querySelectorAll('.nav-item');if(items[n])items[n].classList.add('done');updateProgress();}
function updateProgress(){const c=state.done.length;document.getElementById('progress-pct').textContent=c+' / '+TOTAL;document.getElementById('progress-fill').style.width=(c/TOTAL*100)+'%';}
function check(btn,isCorrect,idx){if(state.answered.includes(idx))return;state.answered.push(idx);const opts=btn.closest('.kcheck-options').querySelectorAll('.kcheck-opt');opts.forEach(o=>{o.classList.add('disabled');o.style.pointerEvents='none';});const fbEl=document.getElementById('fb-'+idx);if(isCorrect){btn.classList.add('correct');fbEl.className='kcheck-feedback show good';fbEl.textContent='‚úì '+fb[idx].good;if(!state.correct.includes(idx))state.correct.push(idx);}else{btn.classList.add('wrong');fbEl.className='kcheck-feedback show bad';fbEl.textContent='‚úó '+fb[idx].bad;opts.forEach(o=>{if(o.getAttribute('onclick')&&o.getAttribute('onclick').includes('true'))o.classList.add('reveal-correct');});}markDone(idx);saveState();}
function toggleCheck(el,idx){if(!state.checks[idx])state.checks[idx]=false;state.checks[idx]=!state.checks[idx];el.classList.toggle('checked',state.checks[idx]);updateChecklist();saveState();}
function updateChecklist(){const total=7,checked=state.checks.filter(Boolean).length;document.getElementById('cl-fill').style.width=(checked/total*100)+'%';document.getElementById('cl-label').textContent=checked+' / '+total;if(checked===total&&!state.done.includes(4))markDone(4);}
function copyCode(btn){const pre=btn.closest('.code-block').querySelector('pre');navigator.clipboard.writeText(pre.innerText).then(()=>{btn.textContent='copied!';setTimeout(()=>btn.textContent='copy',1500);});}
function restoreState(){state.done.forEach(n=>{const items=document.querySelectorAll('.nav-item');if(items[n])items[n].classList.add('done');});state.answered.forEach(idx=>{const opts=document.querySelectorAll('#pane-'+idx+' .kcheck-opt');if(!opts.length)return;opts.forEach(o=>{o.classList.add('disabled');o.style.pointerEvents='none';});const fbEl=document.getElementById('fb-'+idx);if(state.correct.includes(idx)){const co=Array.from(opts).find(o=>o.getAttribute('onclick')&&o.getAttribute('onclick').includes('true'));if(co)co.classList.add('correct');if(fbEl){fbEl.className='kcheck-feedback show good';fbEl.textContent='‚úì '+fb[idx].good;}}else{opts.forEach(o=>{if(o.getAttribute('onclick')&&o.getAttribute('onclick').includes('true'))o.classList.add('reveal-correct');});if(fbEl){fbEl.className='kcheck-feedback show bad';fbEl.textContent='‚úó '+fb[idx].bad;}}});state.checks.forEach((v,i)=>{if(v){const items=document.querySelectorAll('.check-item');if(items[i])items[i].classList.add('checked');}});updateChecklist();updateProgress();goTo(state.current||0);}
restoreState();
</script>
</body>
</html>
