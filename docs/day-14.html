<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Day 14 ‚Äî Week 2 IAM Audit Portfolio</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="shared.css">
</head>
<body>
<div class="shell">

<!-- ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ -->
<nav class="sidebar">
  <div class="sidebar-header">
    <div class="day-badge">Week 2 ¬∑ Day 14</div>
    <h2>Week 2 IAM Audit<br>Portfolio</h2>
    <div class="sidebar-meta">
      <span class="chip">Intermediate</span>
      <span class="chip">4 lessons</span>
      <span class="chip">1 lab</span>
      <span class="chip">~4h</span>
    </div>
  </div>
  <div class="sidebar-back">
    <a class="back-index" href="../index.html">
      <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M7.5 2L3.5 6L7.5 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Course Index
    </a>
    <div class="week-jumps-label">Jump to week</div>
    <div class="week-jumps">
      <a class="week-jump wj1" href="../index.html#week-1">W1</a>
      <a class="week-jump wj2" href="../index.html#week-2">W2</a>
      <a class="week-jump wj3" href="../index.html#week-3">W3</a>
      <a class="week-jump wj4" href="../index.html#week-4">W4</a>
    </div>
    <div class="day-nav-label">Week 2 days</div>
    <div class="day-nav">
      <a class="day-link" href="day-08.html">D8</a>
      <a class="day-link" href="day-09.html">D9</a>
      <a class="day-link" href="day-10.html">D10</a>
      <a class="day-link" href="day-11.html">D11</a>
      <a class="day-link" href="day-12.html">D12</a>
      <a class="day-link" href="day-13.html">D13</a>
      <a class="day-link current" href="day-14.html">D14</a>
    </div>
  </div>

  <div class="lesson-nav">
    <div class="nav-group-label">Lessons</div>
    <div class="nav-item active" onclick="goTo(0)">
      <span class="nav-num">01</span><span class="nav-label">The Five Pillars of an IAM Audit</span><span class="nav-check">‚úì</span>
    </div>
    <div class="nav-item" onclick="goTo(1)">
      <span class="nav-num">02</span><span class="nav-label">Mapping Findings to CIS, NIST & SOC2</span><span class="nav-check">‚úì</span>
    </div>
    <div class="nav-item" onclick="goTo(2)">
      <span class="nav-num">03</span><span class="nav-label">Risk Rating & Remediation SLAs</span><span class="nav-check">‚úì</span>
    </div>
    <div class="nav-item" onclick="goTo(3)">
      <span class="nav-num">04</span><span class="nav-label">Automating the Audit with Boto3</span><span class="nav-check">‚úì</span>
    </div>
    <div class="nav-group-label" style="margin-top:8px">Lab</div>
    <div class="nav-item lab-item" onclick="goTo(4)">
      <span class="nav-num" style="color:var(--lab)">üî¨</span><span class="nav-label">Hands-on: Complete Audit Suite</span><span class="nav-check">‚úì</span>
    </div>
  </div>
  <div class="sidebar-footer">
    <div class="progress-label"><span>Progress</span><span id="progress-pct">0 / 5</span></div>
    <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
  </div>
</nav>

<!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ -->
<div class="main">
  <div class="lesson-topbar">
    <div class="lesson-crumb">Day 14 &nbsp;/&nbsp; <span id="topbar-title">The Five Pillars of an IAM Audit</span></div>
    <div class="nav-arrows">
      <button class="arrow-btn" id="btn-prev" onclick="prev()" disabled>‚Üê Prev</button>
      <button class="arrow-btn" id="btn-next" onclick="next()">Next ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê LESSON 1 ‚Äî Five Pillars ‚ïê‚ïê -->
  <div class="lesson-pane active" id="pane-0">
    <div class="lesson-tag tag-audit">IAM Audit ¬∑ Foundational</div>
    <h1>The Five Pillars of<br>an <em>IAM Audit</em></h1>
    <p>Day 14 is your Week 2 capstone. Rather than introducing new AWS services, you consolidate Days 8‚Äì13 into a single, structured output: an audit report that proves IAM mastery to a hiring manager or CISO.</p>
    <p>A complete IAM audit covers five distinct pillars. Skipping any one leaves exploitable blind spots.</p>

    <div class="pillar-grid">
      <div class="pillar-card">
        <div class="pillar-num">Pillar 01</div>
        <div class="pillar-title">Policy Analysis</div>
        <div class="pillar-detail">Are policies least-privilege? Wildcards present? Over-permissive actions?</div>
        <div class="pillar-tag">IAM Policy Simulator</div>
      </div>
      <div class="pillar-card">
        <div class="pillar-num">Pillar 02</div>
        <div class="pillar-title">Entitlement Review</div>
        <div class="pillar-detail">Who has external or cross-account access? Any internet-exposed resources?</div>
        <div class="pillar-tag">IAM Access Analyzer</div>
      </div>
      <div class="pillar-card">
        <div class="pillar-num">Pillar 03</div>
        <div class="pillar-title">Credential Hygiene</div>
        <div class="pillar-detail">Unused, unrotated, and dormant credentials ‚Äî the silent attacker footholds.</div>
        <div class="pillar-tag">Credentials Report</div>
      </div>
      <div class="pillar-card">
        <div class="pillar-num">Pillar 04</div>
        <div class="pillar-title">Privileged Access</div>
        <div class="pillar-detail">Standing admin roles, SSH key exposure, and absence of JIT controls.</div>
        <div class="pillar-tag">Session Manager + JIT</div>
      </div>
    </div>
    <div class="pillar-card" style="margin-bottom:24px">
      <div class="pillar-num">Pillar 05</div>
      <div class="pillar-title">IaC Compliance</div>
      <div class="pillar-detail">Pre-deploy security checks on CloudFormation and Terraform templates before they reach production.</div>
      <div class="pillar-tag">Checkov</div>
    </div>

    <div class="callout breach">
      <div class="callout-title">‚ö† Real Breach ‚Äî Capital One (2019)</div>
      An attacker exploited a misconfigured WAF role (Pillar 1 failure) with an over-permissive <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;color:var(--danger);background:var(--pill);padding:1px 5px;border-radius:3px">s3:*</code> action. A proper policy analysis audit run months earlier would have flagged the wildcard before the breach occurred.
    </div>

    <div class="callout insight">
      <div class="callout-title">üí° Why All Five Matter</div>
      Real-world entitlement abuse chains multiple pillars: a dormant credential (Pillar 3) with admin access (Pillar 4) that was never deployed through a secure IaC pipeline (Pillar 5). Auditing one pillar alone misses the chain.
    </div>

    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">A Lambda function's execution role has <code style="font-family:'IBM Plex Mono',monospace;color:var(--violet)">s3:*</code> on all buckets. Which audit pillar catches this before the function is deployed to production?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,0)"><span class="opt-key">A</span>Credential Hygiene ‚Äî the Lambda role is a credential and should be in the rotation report</button>
        <button class="kcheck-opt" onclick="check(this,false,0)"><span class="opt-key">B</span>Entitlement Review ‚Äî Access Analyzer would flag the cross-account access</button>
        <button class="kcheck-opt" onclick="check(this,true,0)"><span class="opt-key">C</span>IaC Compliance ‚Äî Checkov scans the CloudFormation template and flags the wildcard action before deployment</button>
        <button class="kcheck-opt" onclick="check(this,false,0)"><span class="opt-key">D</span>Policy Analysis ‚Äî the IAM Policy Simulator would test the action post-deployment</button>
      </div>
      <div class="kcheck-feedback" id="fb-0"></div>
    </div>

    <div class="lesson-nav-footer">
      <button class="prev-btn" disabled>‚Üê Previous</button>
      <button class="next-btn" onclick="next()">Next Lesson ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê LESSON 2 ‚Äî Framework Mapping ‚ïê‚ïê -->
  <div class="lesson-pane" id="pane-1">
    <div class="lesson-tag tag-concept">Frameworks ¬∑ Foundational</div>
    <h1>Mapping Findings to<br><em>CIS, NIST & SOC2</em></h1>
    <p>A finding that isn't mapped to a compliance standard is opinion. One that is mapped is evidence. Auditors, customers, and regulators don't read your instincts ‚Äî they read control IDs.</p>

    <table class="styled-table">
      <thead>
        <tr><th>Standard</th><th>Key IAM Controls</th><th>Where it shows up</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>CIS AWS v1.4</td>
          <td>1.4 ‚Äî No root access keys<br>1.10 ‚Äî MFA on console users<br>1.12 ‚Äî Credentials unused 45d<br>1.14 ‚Äî Keys rotated every 90d<br>1.16 ‚Äî No admin policies on users</td>
          <td class="you">Security Hub ‚Üí CIS Benchmark findings (auto-mapped)</td>
        </tr>
        <tr>
          <td>NIST 800-53</td>
          <td>AC-2 ‚Äî Account management<br>AC-6 ‚Äî Least privilege<br>AC-17 ‚Äî Remote access controls<br>IA-5 ‚Äî Authenticator management</td>
          <td class="you">Required for FedRAMP; common in enterprise RFPs</td>
        </tr>
        <tr>
          <td>SOC2 CC6</td>
          <td>CC6.1 ‚Äî Logical access security<br>CC6.2 ‚Äî New access provisioning<br>CC6.3 ‚Äî Access removal</td>
          <td class="you">Customer trust audits ‚Äî required for B2B SaaS sales</td>
        </tr>
      </tbody>
    </table>

    <div class="callout tip">
      <div class="callout-title">‚úì Practical Habit</div>
      Every finding in your audit report should include its control ID. Example: <em>"CIS 1.14 / NIST IA-5: Access key for user svc-deploy has not been rotated in 127 days. Remediate by [date]."</em> This signals to auditors that you speak their language.
    </div>

    <div class="callout insight">
      <div class="callout-title">üí° SOC2 CC6.3 in Practice</div>
      CC6.3 requires you to remove access when it's no longer needed. The IAM Credentials Report is your primary evidence: it shows dormant users, when you identified them, and ‚Äî after remediation ‚Äî that they were disabled. Auditors look for this loop: identify ‚Üí act ‚Üí evidence.
    </div>

    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Your audit finds a user who hasn't logged in for 120 days but still has an active access key. Which CIS control does this directly violate?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,1)"><span class="opt-key">A</span>CIS 1.4 ‚Äî Ensure no root account access keys exist</button>
        <button class="kcheck-opt" onclick="check(this,false,1)"><span class="opt-key">B</span>CIS 1.10 ‚Äî Ensure MFA is enabled for all IAM users with console access</button>
        <button class="kcheck-opt" onclick="check(this,true,1)"><span class="opt-key">C</span>CIS 1.12 ‚Äî Ensure credentials unused for 45 days or more are disabled</button>
        <button class="kcheck-opt" onclick="check(this,false,1)"><span class="opt-key">D</span>CIS 1.16 ‚Äî Ensure IAM policies are attached only to groups or roles, not users</button>
      </div>
      <div class="kcheck-feedback" id="fb-1"></div>
    </div>

    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn" onclick="next()">Next Lesson ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê LESSON 3 ‚Äî Risk Rating ‚ïê‚ïê -->
  <div class="lesson-pane" id="pane-2">
    <div class="lesson-tag tag-warning">Risk Ratings ¬∑ Intermediate</div>
    <h1>Risk Rating &<br><em>Remediation SLAs</em></h1>
    <p>Not all findings are equal. A professional audit ranks each by <strong>Risk = Likelihood √ó Impact</strong>, then assigns a non-negotiable remediation deadline. This is what separates a security checklist from a business deliverable.</p>

    <table class="styled-table">
      <thead><tr><th>Severity</th><th>Example Finding</th><th>SLA</th></tr></thead>
      <tbody>
        <tr>
          <td class="sev-c">Critical</td>
          <td>Root account used in the last 30 days with an active access key</td>
          <td>24 hours</td>
        </tr>
        <tr>
          <td class="sev-h">High</td>
          <td>Active IAM admin user with <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">AdministratorAccess</code> and no MFA enabled</td>
          <td>72 hours</td>
        </tr>
        <tr>
          <td class="sev-m">Medium</td>
          <td>Unused IAM role with S3 wildcard action, inactive for 90 days</td>
          <td>2 weeks</td>
        </tr>
        <tr>
          <td class="sev-l">Low</td>
          <td>Password policy missing symbol-character requirement</td>
          <td>30 days</td>
        </tr>
      </tbody>
    </table>

    <p>A finding entry in your report must answer five questions:</p>

    <div class="audit-flow">
      <div class="audit-row">
        <div class="audit-cell head">Field</div>
        <div class="audit-cell head">What to write</div>
        <div class="audit-cell head">Example</div>
      </div>
      <div class="audit-row">
        <div class="audit-cell label">What it is</div>
        <div class="audit-cell">Plain-language description of the misconfiguration</div>
        <div class="audit-cell" style="color:var(--muted);font-size:12.5px">svc-deploy has iam:PassRole on all resources (*)</div>
      </div>
      <div class="audit-row">
        <div class="audit-cell label">Why it matters</div>
        <div class="audit-cell">Business risk, blast radius, regulation</div>
        <div class="audit-cell" style="color:var(--muted);font-size:12.5px">Allows privilege escalation to any role in the account ‚Äî full compromise</div>
      </div>
      <div class="audit-row">
        <div class="audit-cell label">Exact fix</div>
        <div class="audit-cell">Specific remediation command or console path</div>
        <div class="audit-cell" style="color:var(--muted);font-size:12.5px">Scope PassRole to arn:aws:iam::*:role/deploy-* only</div>
      </div>
      <div class="audit-row">
        <div class="audit-cell label">Owner</div>
        <div class="audit-cell">Which team or person is responsible</div>
        <div class="audit-cell" style="color:var(--muted);font-size:12.5px">Platform Engineering team</div>
      </div>
      <div class="audit-row">
        <div class="audit-cell label">By when</div>
        <div class="audit-cell">SLA date derived from severity</div>
        <div class="audit-cell" style="color:var(--muted);font-size:12.5px">Critical ‚Üí within 24 hours of report delivery</div>
      </div>
    </div>

    <div class="callout warning">
      <div class="callout-title">‚ö† Common Mistake</div>
      Listing findings without remediation steps is a checklist, not an audit. Every finding needs all five fields. A CISO cannot action "iam:PassRole on *" ‚Äî they need the exact scope change, the owner, and the deadline.
    </div>

    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">An active admin user with <code style="font-family:'IBM Plex Mono',monospace;color:var(--violet)">AdministratorAccess</code> has no MFA and logged in two days ago. What is the correct severity and SLA?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,2)"><span class="opt-key">A</span>Low ‚Äî the user is actively logging in, proving it's a legitimate account</button>
        <button class="kcheck-opt" onclick="check(this,false,2)"><span class="opt-key">B</span>Medium ‚Äî MFA can be added without urgency since the account is in active use</button>
        <button class="kcheck-opt" onclick="check(this,true,2)"><span class="opt-key">C</span>High ‚Äî active admin without MFA; one phished password gives full account access. Remediate within 72 hours.</button>
        <button class="kcheck-opt" onclick="check(this,false,2)"><span class="opt-key">D</span>Critical ‚Äî only if the user also has an active access key with no expiry</button>
      </div>
      <div class="kcheck-feedback" id="fb-2"></div>
    </div>

    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn" onclick="next()">Next Lesson ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê LESSON 4 ‚Äî Boto3 Automation ‚ïê‚ïê -->
  <div class="lesson-pane" id="pane-3">
    <div class="lesson-tag tag-ops">Automation ¬∑ Intermediate</div>
    <h1>Automating the Audit<br>with <em>Boto3</em></h1>
    <p>Manual audits don't scale past a handful of users. At 50+ IAM identities, automation is mandatory. Two built-in AWS sources cover most of the credential hygiene pillar automatically.</p>

    <p><strong>Source 1 ‚Äî IAM Credentials Report</strong><br>Generated on-demand, this CSV covers every IAM user: password age, access key age, last-used dates, and MFA status. It maps directly to CIS 1.10, 1.12, and 1.14.</p>

    <div class="code-block">
      <div class="code-header"><span class="code-lang">python ¬∑ flag dormant credentials</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div>
      <pre><span class="hl">import</span> boto3, csv
<span class="hl">from</span> datetime <span class="hl">import</span> datetime, timezone, timedelta

iam = boto3.client(<span class="hl2">'iam'</span>)
iam.generate_credential_report()
report = iam.get_credential_report()[<span class="hl2">'Content'</span>].decode()
threshold = timedelta(days=<span class="hl2">90</span>)

<span class="hl">for</span> row <span class="hl">in</span> csv.DictReader(report.splitlines()):
    last_used = row[<span class="hl2">'password_last_used'</span>]
    <span class="hl">if</span> last_used <span class="hl">not in</span> (<span class="hl2">'N/A'</span>, <span class="hl2">'no_information'</span>):
        age = datetime.now(timezone.utc) - datetime.fromisoformat(last_used)
        <span class="hl">if</span> age > threshold:
            <span class="comment"># CIS 1.12 violation ‚Äî log to findings register</span>
            print(f<span class="hl2">"DORMANT [{age.days}d]: {row['user']}"</span>)</pre>
    </div>

    <p><strong>Source 2 ‚Äî Access Analyzer Findings API</strong><br>Access Analyzer continuously monitors for external and cross-account access. Export its findings to CSV as your Entitlement Review evidence. Both sources feed directly into your Findings Register.</p>

    <div class="code-block">
      <div class="code-header"><span class="code-lang">python ¬∑ export analyzer findings</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div>
      <pre>analyzer = boto3.client(<span class="hl2">'accessanalyzer'</span>, region_name=<span class="hl2">'us-east-1'</span>)

<span class="comment"># List all active analyzers first</span>
analyzers = analyzer.list_analyzers()[<span class="hl2">'analyzers'</span>]

<span class="hl">for</span> a <span class="hl">in</span> analyzers:
    findings = analyzer.list_findings(
        analyzerArn=a[<span class="hl2">'arn'</span>],
        filter={<span class="hl2">'status'</span>: {<span class="hl2">'eq'</span>: [<span class="hl2">'ACTIVE'</span>]}}
    )[<span class="hl2">'findings'</span>]
    <span class="hl">for</span> f <span class="hl">in</span> findings:
        print(f[<span class="hl2">'resourceType'</span>], f[<span class="hl2">'condition'</span>], f[<span class="hl2">'isPublic'</span>])</pre>
    </div>

    <div class="callout tip">
      <div class="callout-title">‚úì Portfolio Tip</div>
      Save both script outputs as files in your GitHub repo: <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">evidence/day14-dormant-credentials.txt</code> and <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">evidence/day14-access-analyzer-findings.csv</code>. These are exactly the artefacts a cloud security auditor produces on day one of an engagement.
    </div>

    <!-- Assessment block inside lesson 4 -->
    <h2 style="font-family:'DM Serif Display',serif;font-size:20px;color:#e4eaf6;margin:36px 0 16px;font-weight:400">Assessments</h2>
    <p style="font-size:13px;color:var(--muted);margin-bottom:20px">Complete these as written work to include in your portfolio. Use the hints only if you're stuck for more than 10 minutes.</p>

    <div class="assessment-box foundational">
      <div class="assessment-box-head">üå± Foundational Assessment</div>
      <div class="assessment-box-body">
        <ol>
          <li>Name the five IAM audit pillars and give one AWS service and one compliance standard for each.</li>
          <li>Explain in plain English what the IAM Credentials Report contains and why it matters for a SOC2 CC6.3 audit.</li>
          <li>Write a one-paragraph executive summary for this finding: "4 of 12 IAM users have not logged in for 120+ days and retain active access keys." Include the business risk, the regulation, and the cost-to-fix estimate.</li>
        </ol>
        <div class="callout tip" style="margin-top:16px;margin-bottom:0">
          <div class="callout-title">üí° Hint for item 3</div>
          Ask yourself three questions: What data is at risk if one of these keys is phished? What regulation requires you to disable dormant accounts? How many engineering hours does it take to run a <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">aws iam update-login-profile --no-password-reset-required</code> on four accounts? Answer those in 3‚Äì4 sentences.
        </div>
      </div>
    </div>

    <div class="assessment-box intermediate" style="margin-top:16px">
      <div class="assessment-box-head">‚ö° Intermediate Assessment</div>
      <div class="assessment-box-body">
        <ol>
          <li>Write a complete findings register entry (ID, severity, CIS control, description, business impact, exact fix, owner, SLA) for an IAM role with <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">iam:PassRole</code> scoped to <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">Resource: "*"</code>.</li>
          <li>Explain why <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">iam:PassRole</code> with <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">Resource: "*"</code> is a privilege escalation path even if the role has no other admin permissions.</li>
          <li>Describe how Checkov and IAM Access Analyzer complement each other ‚Äî what gaps does each leave that the other fills?</li>
        </ol>
        <div class="callout insight" style="margin-top:16px;margin-bottom:0">
          <div class="callout-title">üí° Hint for item 2</div>
          If you can <code style="font-family:'IBM Plex Mono',monospace;font-size:12px;background:var(--pill);padding:1px 5px;border-radius:3px;color:var(--violet)">iam:PassRole</code> any role to a new EC2 instance ‚Äî what role would you pass? Then what actions does that role allow you to take once the instance is running? Work through the chain from PassRole to full account access.
        </div>
      </div>
    </div>

    <div class="kcheck">
      <div class="kcheck-label">Knowledge Check</div>
      <div class="kcheck-q">Which AWS service generates an on-demand CSV listing every IAM user's password last-used date, access key age, rotation date, and MFA status?</div>
      <div class="kcheck-options">
        <button class="kcheck-opt" onclick="check(this,false,3)"><span class="opt-key">A</span>AWS Security Hub ‚Äî it aggregates all IAM findings from multiple services</button>
        <button class="kcheck-opt" onclick="check(this,false,3)"><span class="opt-key">B</span>IAM Access Analyzer ‚Äî it reports on external and cross-account access patterns</button>
        <button class="kcheck-opt" onclick="check(this,true,3)"><span class="opt-key">C</span>IAM Credentials Report ‚Äî generated via Console or <code style="font-family:'IBM Plex Mono',monospace">aws iam generate-credential-report</code></button>
        <button class="kcheck-opt" onclick="check(this,false,3)"><span class="opt-key">D</span>AWS Config ‚Äî it tracks resource configuration history across all supported types</button>
      </div>
      <div class="kcheck-feedback" id="fb-3"></div>
    </div>

    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn lab-btn" onclick="next()">Start Lab ‚Üí</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê LAB ‚ïê‚ïê -->
  <div class="lesson-pane lab-pane" id="pane-4">
    <div class="lesson-tag tag-lab">üî¨ Hands-On Lab</div>
    <h1>Complete<br><em>Audit Suite</em></h1>
    <p>Work through each step in sequence. Every step produces an artefact you commit to GitHub at the end. Keep your AWS console and a terminal open alongside this page.</p>

    <div class="callout lab-note">
      <div class="callout-title">‚ö° Before You Start</div>
      This is a consolidation lab ‚Äî you are not creating new resources, only auditing and documenting what you built in Days 8‚Äì13. No new services means no new charges.
    </div>

    <div class="lab-steps">

      <div class="lab-step" id="step-0">
        <div class="step-num-wrap"><div class="step-num">1</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Generate the IAM Credentials Report <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~10 min</span></div>
          <div class="step-body">
            <ol>
              <li>Console: <strong>IAM ‚Üí Credential Report ‚Üí Generate report ‚Üí Download CSV</strong></li>
              <li>Or CLI: <code>aws iam generate-credential-report</code> then <code>aws iam get-credential-report --output text --query Content | base64 -d > credentials-report.csv</code></li>
              <li>Open the CSV and highlight any row where <code>password_last_used</code> is older than 45 days or <code>mfa_active</code> is <code>false</code></li>
              <li>Save as <code>evidence/day14-credentials-report.csv</code></li>
            </ol>
          </div>
        </div>
      </div>

      <div class="lab-step" id="step-1">
        <div class="step-num-wrap"><div class="step-num">2</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Export Access Analyzer Findings <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~10 min</span></div>
          <div class="step-body">
            <ol>
              <li>Console: <strong>IAM ‚Üí Access Analyzer ‚Üí Active findings ‚Üí Export to CSV</strong></li>
              <li>Take a screenshot of the findings dashboard showing the count of active findings</li>
              <li>Save CSV as <code>evidence/day14-access-analyzer-findings.csv</code> and screenshot as <code>evidence/day14-access-analyzer.png</code></li>
            </ol>
          </div>
        </div>
      </div>

      <div class="lab-step" id="step-2">
        <div class="step-num-wrap"><div class="step-num">3</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Capture Security Hub CIS IAM Controls <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~10 min</span></div>
          <div class="step-body">
            <ol>
              <li>Console: <strong>Security Hub ‚Üí CIS AWS Foundations ‚Üí Filter by FAILED ‚Üí filter controls 1.x only</strong></li>
              <li>Screenshot the filtered list showing your current pass/fail counts</li>
              <li>Save as <code>evidence/day14-security-hub-iam.png</code></li>
            </ol>
          </div>
        </div>
      </div>

      <div class="lab-step" id="step-3">
        <div class="step-num-wrap"><div class="step-num">4</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Run Checkov on Your Week 2 Templates <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~15 min</span></div>
          <div class="step-body">
            <ol>
              <li>Terminal: <code>checkov -f week-2/labs/day-11-vpc.yaml --framework cloudformation -o json > evidence/day14-checkov-results.json</code></li>
              <li>Note the count of PASSED vs FAILED checks in the JSON output</li>
              <li>If Checkov is not installed: <code>pip install checkov</code></li>
            </ol>
          </div>
        </div>
      </div>

      <div class="lab-step" id="step-4">
        <div class="step-num-wrap"><div class="step-num">5</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Write the IAM Audit Report <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~45 min ¬∑ Main deliverable</span></div>
          <div class="step-body">
            <p>Create <code>portfolio/week2-iam-audit-report.md</code> with three sections:</p>
            <ul>
              <li><strong>Executive Summary</strong> ‚Äî 3 headlines for a CISO: risk posture, regulatory exposure, remediation cost</li>
              <li><strong>Findings Register</strong> ‚Äî Table: ID | Severity | CIS Control | Description | Business Impact | Fix | Owner | SLA. Minimum 5 findings from your evidence above.</li>
              <li><strong>Technical Appendix</strong> ‚Äî Links to all evidence files collected in Steps 1‚Äì4</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="lab-step" id="step-5">
        <div class="step-num-wrap"><div class="step-num">6</div><div class="step-connector"></div></div>
        <div class="step-content">
          <div class="step-title">Commit Week 2 GitHub Portfolio <span style="font-size:12px;color:var(--muted);font-family:'IBM Plex Mono',monospace">~15 min</span></div>
          <div class="step-body">
            <div class="code-block" style="margin-top:8px">
              <div class="code-header"><span class="code-lang">bash</span><button class="copy-btn" onclick="copyCode(this)">copy</button></div>
              <pre>git add evidence/ portfolio/week2-iam-audit-report.md
git commit -m <span class="hl2">"Day 14: Week 2 IAM Audit Portfolio ‚Äî 5 findings documented"</span>
git push</pre>
            </div>
            <p style="font-size:13px;color:#8a92a8;margin-top:8px">Update your README.md Week 2 progress badge to ‚úÖ and screenshot your GitHub commit history for the portfolio.</p>
          </div>
        </div>
      </div>

    </div><!-- /lab-steps -->

    <h2 style="font-family:'DM Serif Display',serif;font-size:20px;color:#e4eaf6;margin:32px 0 16px;font-weight:400">Completion Checklist</h2>
    <p style="font-size:13px;color:var(--muted);margin-bottom:16px">Tick each item as you complete it.</p>

    <div class="checklist-progress">
      <div class="checklist-progress-bar"><div class="checklist-progress-fill" id="cl-fill"></div></div>
      <span class="checklist-progress-label" id="cl-label">0 / 7</span>
    </div>

    <div class="checklist" id="checklist">
      <div class="check-item" onclick="toggleCheck(this,0)"><div class="check-box">‚úì</div><div class="check-text">IAM Credentials Report CSV downloaded and dormant users identified</div></div>
      <div class="check-item" onclick="toggleCheck(this,1)"><div class="check-box">‚úì</div><div class="check-text">Access Analyzer findings exported to CSV with dashboard screenshot</div></div>
      <div class="check-item" onclick="toggleCheck(this,2)"><div class="check-box">‚úì</div><div class="check-text">Security Hub CIS IAM controls screenshot captured (1.x controls filtered)</div></div>
      <div class="check-item" onclick="toggleCheck(this,3)"><div class="check-box">‚úì</div><div class="check-text">Checkov scan JSON output saved for Week 2 CloudFormation template</div></div>
      <div class="check-item" onclick="toggleCheck(this,4)"><div class="check-box">‚úì</div><div class="check-text">IAM Audit Report written with Executive Summary, Findings Register (‚â• 5 findings), and Technical Appendix</div></div>
      <div class="check-item" onclick="toggleCheck(this,5)"><div class="check-box">‚úì</div><div class="check-text">Week 2 GitHub commit pushed and README badge updated to ‚úÖ</div></div>
      <div class="check-item" onclick="toggleCheck(this,6)"><div class="check-box">‚úì</div><div class="check-text">All temporary Week 2 resources cleaned up (no unexpected charges)</div></div>
    </div>

    <div class="lesson-nav-footer">
      <button class="prev-btn" onclick="prev()">‚Üê Previous</button>
      <button class="next-btn lab-btn" onclick="finish()">Complete Day 14 ‚úì</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê COMPLETION ‚ïê‚ïê -->
  <div class="lesson-pane" id="pane-complete">
    <div class="completion-card">
      <span class="completion-icon">üóÇÔ∏è</span>
      <h1>Week 2 Complete</h1>
      <p>You have consolidated Zero Trust, CIEM, JIT, IaC scanning, and privileged access into a CISO-ready IAM audit portfolio. Week 3 begins with VPC Network Foundation.</p>
      <div class="score-pill"><span>‚ö°</span> Quiz: <span id="score-val">‚Äî</span></div><br>
      <div class="lab-score-pill"><span>üî¨</span> Lab: <span id="lab-score-val">‚Äî</span> checklist items</div>
      <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:8px">
        <button class="prev-btn" onclick="goTo(0);resetAll()">‚Ü© Review</button>
        <a href="../index.html" style="text-decoration:none"><button class="next-btn" style="background:var(--pill);color:var(--muted);border:1px solid var(--border-hi)">‚Üê Course Index</button></a>
        <a href="day-15.html"><button class="next-btn lab-btn">Week 3 ‚Üí</button></a>
      </div>
    </div>
  </div>

</div><!-- /main -->
</div><!-- /shell -->

<script src="csm-core.js"></script>
<script>
initPage({
  storageKey: 'csm-day14',
  total: 5,
  quizCount: 4,
  checkTotal: 6,
  titles: [
  'The Five Pillars of an IAM Audit',
  'Mapping Findings to CIS, NIST & SOC2',
  'Risk Rating & Remediation SLAs',
  'Automating the Audit with Boto3',
  'Hands-on: Complete Audit Suite'
],
  fb: {
  0:{
    good:"Correct. IaC Compliance uses Checkov to scan CloudFormation and Terraform templates pre-deployment. This catches wildcard actions before they ever reach a running resource ‚Äî mapping to PCI DSS 6.4.3. The Policy Simulator (Pillar 1) tests live policies, not templates.",
    bad:"Not quite. The key phrase is 'before the function is deployed to production.' Checkov (IaC Compliance) catches this at the template stage. Access Analyzer monitors running resources, not code yet to be deployed."
  },
  1:{
    good:"Correct. CIS 1.12 states that credentials unused for 45 days or more must be disabled. 120 days of inactivity is a clear violation. Security Hub flags this automatically when the CIS Benchmark is enabled.",
    bad:"Not quite. CIS 1.4 covers root access keys, 1.10 covers MFA, and 1.16 covers policy attachment scope. The control for dormant credentials ‚Äî unused for 45+ days ‚Äî is CIS 1.12."
  },
  2:{
    good:"Correct. An active admin without MFA is a High finding ‚Äî CIS 1.10 violation ‚Äî with a 72-hour remediation SLA. The fix is to enforce MFA via an IAM condition or disable console access until MFA is configured. It would only reach Critical if the user also had an active access key with no MFA bypass controls at all.",
    bad:"Not quite. 'Active use' doesn't reduce the risk ‚Äî it means the account is being targeted by phishing. AdministratorAccess without MFA means one stolen password equals full account compromise. The severity is High with a 72-hour SLA."
  },
  3:{
    good:"Correct. The IAM Credentials Report is generated on-demand via the IAM console or the CLI. It is the primary data source for the Credential Hygiene pillar, covering CIS controls 1.10, 1.12, and 1.14 in a single exportable CSV.",
    bad:"Not quite. Security Hub aggregates findings but doesn't generate raw credential data. Access Analyzer covers external access patterns, not credential ages. Config tracks resource configuration history. The Credentials Report is the dedicated per-user credential snapshot."
  }
}
});
</script>
</body>
</html>
